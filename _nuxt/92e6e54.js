(window.webpackJsonp=window.webpackJsonp||[]).push([[13,17,23],{358:function(t,e,r){"use strict";r.r(e);var n={props:["label","type","id","autofocus","width","value"],data:function(){return{on_focus:!1,style:{height:40},input:{style:{},model:""}}},methods:{updateInput:function(){this.$emit("input",this.$refs.cinput.value)},focusInput:function(){this.$refs.cinput.focus()}},mounted:function(){},created:function(){}},o=r(7),component=Object(o.a)(n,(function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("div",{style:t.input.style},[r("div",{staticClass:"text-xs duration-300 flex items-center font-bold h-4"},[r("label",{staticClass:"z-10 px-1 text-indigo-600",attrs:{for:t.id}},[t._v(" "+t._s(t.label)+" ")])]),t._v(" "),r("input",{ref:"cinput",staticClass:"input-alt w-full duration-300 text-xs",attrs:{autofocus:t.autofocus,id:t.id,type:t.type,placeholder:t.label},domProps:{value:t.value},on:{input:function(e){return t.updateInput()},focus:function(){t.on_focus=!0,t.$emit("focus")},blur:function(){t.on_focus=!1,t.$emit("blur")}}})])}),[],!1,null,"a221d83e",null);e.default=component.exports},359:function(t,e,r){var content=r(361);content.__esModule&&(content=content.default),"string"==typeof content&&(content=[[t.i,content,""]]),content.locals&&(t.exports=content.locals);(0,r(27).default)("2d1dc0a2",content,!0,{sourceMap:!1})},360:function(t,e,r){"use strict";r(359)},361:function(t,e,r){var n=r(26)((function(i){return i[1]}));n.push([t.i,"/*purgecss start ignore*/\n.fade-enter-active,.fade-leave-active{\n  transition:opacity .3s\n}\n.fade-enter,.fade-leave-to{\n  opacity:0\n}\n\n/*purgecss end ignore*/",""]),n.locals={},t.exports=n},362:function(t,e,r){"use strict";r.r(e);var n={props:["value","datas","label","code","placeholder","padding","width"],watch:{datas:function(a){this.$emit("input",void 0===a[0]?null:a[0][this.code])}},data:function(){return{}},methods:{updateInput:function(){this.$emit("input",this.$refs.cinput.value)}},mounted:function(){}},o=(r(360),r(7)),component=Object(o.a)(n,(function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("div",{staticClass:"relative flex flex-col"},[t.placeholder?r("div",{staticClass:"text-xs duration-300 flex items-center font-bold",class:t.datas.length>0?" h-4":"h-0"},[t.datas.length>0?r("label",{staticClass:"z-10 px-1 text-indigo-600"},[t._v(" "+t._s(t.placeholder)+" ")]):t._e()]):t._e(),t._v(" "),r("div",[r("select",{ref:"cinput",staticClass:"input-alt w-full duration-300 text-xs",on:{change:function(e){return t.updateInput()}}},t._l(t.datas,(function(e){return r("option",{key:e[t.code],domProps:{value:e[t.code],selected:t.value==e[void 0===t.code?"code":t.code]}},[t._v(" "+t._s(e[void 0===t.label?"label":t.label])+" ")])})),0)])])}),[],!1,null,null,null);e.default=component.exports},609:function(t,e,r){"use strict";r.r(e);var n=r(3),o=(r(21),r(63),r(25),{watch:{services:function(a){a.length>0?this.in_insert_serv=!1:this.in_insert_serv=!0},$route:function(t,e){t.query.action&&"edit"==t.query.action&&(this.action="edit",this.getTarifAndAllServices(t.query.tr_id))},"tr.cat_id":function(a){for(var t=[],i=0;i<this.formats.length;i++){var e=this.formats[i];e.parent_cat_id==a&&t.push(e)}this.tmp_formats=t},"tpm_model.tpm_month":function(a){this.tpm[0]&&(this.tpm_model.tpm_taxe_communale=a>0?this.taxe_.p/this.taxe_.m*parseInt(a):0)}},data:function(){return{regs:[],cats:[],formats:[],services:[],tmp_formats:[],in_validate:!1,cur_tr:{},tr:{reg_id:0,cat_id:0,format_id:0},tpm:{},tpm_model:{tpm_location:"",tpm_taxe_location:"",tpm_month:""},tps_model:{},tps:{},action:"add",in_insert_serv:!1,taxe_:{m:0,p:0}}},methods:{getDataUtilsTarif:function(){var t=this;return Object(n.a)(regeneratorRuntime.mark((function e(){var r;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,t.$axios.$get("api/a/tr/ad/data-utils");case 3:(r=e.sent).status?(t.cats=r.cats,t.tr.cat_id=t.cats[0].cat_id,t.regs=r.regs,t.tr.reg_id=r.regs[0].reg_id,t.formats=r.formats,t.services=r.services):t.showNotif("Erreur",r.message,!0),e.next=10;break;case 7:e.prev=7,e.t0=e.catch(0),t.showErrorConnexion();case 10:case"end":return e.stop()}}),e,null,[[0,7]])})))()},validateTarif:function(){var t=this;return Object(n.a)(regeneratorRuntime.mark((function e(){var r,n;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,t.$axios.$post("api/a/tr/tarif",t.tr);case 3:(r=e.sent).status?(n={action:"edit",tr_id:r.tr_id},t.$router.replace({query:n})):t.showNotif("Erreur d'ajout",r.message,!0),e.next=10;break;case 7:e.prev=7,e.t0=e.catch(0),t.showErrorConnexion();case 10:case"end":return e.stop()}}),e,null,[[0,7]])})))()},getTarifAndAllServices:function(t){var e=this;return Object(n.a)(regeneratorRuntime.mark((function r(){var n;return regeneratorRuntime.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return r.prev=0,r.next=3,e.$axios.$get("api/a/tr/view/".concat(t));case 3:(n=r.sent).status?(e.tr=n.tr,e.tps=n.tps,e.tpm=n.tpm,e.tpm[0]&&(e.taxe_.m=parseInt(e.tpm[0].tpm_month),e.taxe_.p=parseInt(e.tpm[0].tpm_taxe_communale)),e.services=n.services,e.services.length<=0&&(e.in_insert_serv=!0)):e.showNotif("Erreur",n.message,!0),r.next=10;break;case 7:r.prev=7,r.t0=r.catch(0),e.showErrorConnexion();case 10:case"end":return r.stop()}}),r,null,[[0,7]])})))()},postTarifPerMonth:function(){var t=this;return Object(n.a)(regeneratorRuntime.mark((function e(){var r;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,t.$axios.$post("api/a/tr/tpm",{tpm:t.tpm_model,tr_id:t.tr.tr_id});case 3:(r=e.sent).status?t.getTPM():t.showNotif("Erreur",r.message,!0),e.next=10;break;case 7:e.prev=7,e.t0=e.catch(0),t.showErrorConnexion();case 10:case"end":return e.stop()}}),e,null,[[0,7]])})))()},getTPM:function(){var t=this;return Object(n.a)(regeneratorRuntime.mark((function e(){var r;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,t.$axios.$get("api/a/tr/tpm/"+t.tr.tr_id);case 3:(r=e.sent).status?(t.tpm=r.tpm,t.tpm[0]&&(t.taxe_.m=parseInt(t.tpm[0].tpm_month),t.taxe_.p=parseInt(t.tpm[0].tpm_taxe_communale)),console.log(t.taxe_)):t.showNotif("Erreur",r.message,!0),e.next=10;break;case 7:e.prev=7,e.t0=e.catch(0),t.showErrorConnexion();case 10:case"end":return e.stop()}}),e,null,[[0,7]])})))()},deleteTpm:function(t){var e=this;return Object(n.a)(regeneratorRuntime.mark((function r(){return regeneratorRuntime.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return r.prev=0,r.next=3,e.$axios.$delete("api/a/tr/tpm/".concat(t));case 3:r.sent.status?e.getTPM():e.showErrorConnexion(),r.next=10;break;case 7:r.prev=7,r.t0=r.catch(0),e.showErrorConnexion();case 10:case"end":return r.stop()}}),r,null,[[0,7]])})))()},getTps:function(){var t=this;return Object(n.a)(regeneratorRuntime.mark((function e(){var r;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,t.$axios.$get("api/a/tr/tps/"+t.tr.tr_id);case 3:(r=e.sent).status&&(t.tps=r.tps,t.services=r.services),e.next=10;break;case 7:e.prev=7,e.t0=e.catch(0),t.showErrorConnexion();case 10:case"end":return e.stop()}}),e,null,[[0,7]])})))()},postTps:function(){var t=this;return Object(n.a)(regeneratorRuntime.mark((function e(){var r;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,t.$axios.post("api/a/tr/tps",{tps:t.tps_model,tr_id:t.tr.tr_id});case 3:(r=e.sent).status?t.getTps():t.showNotif("Erreur d'ajout",r.message,!0),e.next=10;break;case 7:e.prev=7,e.t0=e.catch(0),t.showErrorConnexion();case 10:case"end":return e.stop()}}),e,null,[[0,7]])})))()},deleteTps:function(t){var e=this;return Object(n.a)(regeneratorRuntime.mark((function r(){return regeneratorRuntime.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return r.prev=0,r.next=3,e.$axios.$delete("api/a/tr/tps/".concat(t));case 3:r.sent.status?e.getTps():e.showErrorConnexion(),r.next=10;break;case 7:r.prev=7,r.t0=r.catch(0),e.showErrorConnexion();case 10:case"end":return r.stop()}}),r,null,[[0,7]])})))()},init:function(){this.tps_model.type=this.panel_impression_type[0].code},changeSelection:function(){this.action="add",this.getDataUtilsTarif(),this.$router.replace({query:{}})}},mounted:function(){this.$route.query.action&&"edit"==this.$route.query.action?(this.action="edit",this.getTarifAndAllServices(this.$route.query.tr_id)):(this.action="add",this.getDataUtilsTarif()),this.init()}}),c=r(7),component=Object(c.a)(o,(function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("div",["add"==t.action?r("div",{staticClass:"flex flex-col"},[t._m(0),t._v(" "),r("div",{staticClass:"flex items-end py-2 border-b"},[r("c-select",{attrs:{datas:t.regs,placeholder:"Régisseur ...",label:"reg_label",code:"reg_id"},model:{value:t.tr.reg_id,callback:function(e){t.$set(t.tr,"reg_id",e)},expression:"tr.reg_id"}}),t._v(" "),r("c-select",{staticClass:"ml-2",attrs:{datas:t.cats,placeholder:"Catégorie ...",label:"cat_label",code:"cat_id"},model:{value:t.tr.cat_id,callback:function(e){t.$set(t.tr,"cat_id",e)},expression:"tr.cat_id"}}),t._v(" "),t.tmp_formats.length>0?r("c-select",{staticClass:"ml-2",attrs:{datas:t.tmp_formats,placeholder:"Formats ...",label:"cat_label",code:"cat_id"},model:{value:t.tr.format_id,callback:function(e){t.$set(t.tr,"format_id",e)},expression:"tr.format_id"}}):t._e(),t._v(" "),r("button",{staticClass:" bt ml-2",on:{click:t.validateTarif}},[t._v(" Valider ")])],1)]):t._e(),t._v(" "),"edit"==t.action?r("div",{staticClass:"mt-2"},[r("div",{staticClass:"flex border-b py-2"},[r("div",{staticClass:" flex flex-col mr-2"},[r("span",{staticClass:"text-xs font-bold"},[t._v(" Regisseur ")]),t._v(" "),r("span",{staticClass:"text-sm"},[t._v(" "+t._s(t.tr.reg_label)+" ")])]),t._v(" "),r("div",{staticClass:" flex flex-col mr-2"},[r("span",{staticClass:"text-xs font-bold"},[t._v(" Catégorie ")]),t._v(" "),r("span",{staticClass:"text-sm"},[t._v(" "+t._s(t.tr.cat_label)+" ")])]),t._v(" "),r("div",{staticClass:" flex flex-col "},[r("span",{staticClass:"text-xs font-bold"},[t._v(" Format ")]),t._v(" "),r("span",{staticClass:"text-sm"},[t._v(" "+t._s(t.tr.format_label)+" ")])]),t._v(" "),r("span",{staticClass:"flex-grow"}),t._v(" "),r("button",{staticClass:"bt-back text-sm",on:{click:function(e){return t.changeSelection()}}},[t._v("\n                Changer\n            ")])]),t._v(" "),r("div",{staticClass:"border-b py-2"},[t._m(1),t._v(" "),r("div",{staticClass:"flex items-end border-b py-2"},[r("custom-input",{staticClass:"w-20 mr-2",attrs:{label:"Mois",type:"number"},model:{value:t.tpm_model.tpm_month,callback:function(e){t.$set(t.tpm_model,"tpm_month",e)},expression:"tpm_model.tpm_month"}}),t._v(" "),r("custom-input",{staticClass:"mr-2",attrs:{label:"Prix taxe Communale"},model:{value:t.tpm_model.tpm_taxe_communale,callback:function(e){t.$set(t.tpm_model,"tpm_taxe_communale",e)},expression:"tpm_model.tpm_taxe_communale"}}),t._v(" "),r("custom-input",{staticClass:"mr-2",attrs:{label:"Prix Location"},model:{value:t.tpm_model.tpm_location,callback:function(e){t.$set(t.tpm_model,"tpm_location",e)},expression:"tpm_model.tpm_location"}}),t._v(" "),r("button",{staticClass:" text-sm bt",on:{click:t.postTarifPerMonth}},[t._v(" Ajouter ")])],1),t._v(" "),t.tpm.length<=0?r("div",{staticClass:" flex justify-center items-center p-2 text-sm "},[r("span",[t._v(" Aucun Service par mois ajouter pour le moment ")])]):r("div",{staticClass:"  pt-2 text-sm"},[r("table",{staticClass:"w-full"},[t._m(2),t._v(" "),r("tbody",t._l(t.tpm,(function(e){return r("tr",{key:e.tpm_id,staticClass:"border-b"},[r("td",{staticClass:"py-1 px-2"},[t._v(" "+t._s(e.tpm_month)+" ")]),t._v(" "),r("td",{staticClass:"py-1 px-2"},[t._v(" "+t._s(t.separateNumber(e.tpm_taxe_communale))+" ")]),t._v(" "),r("td",{staticClass:"py-1 px-2"},[t._v(" "+t._s(t.separateNumber(e.tpm_location))+" ")]),t._v(" "),r("td",{staticClass:"py-1 px-2"},[r("button",{staticClass:"bt-prev-next",on:{click:function(r){return t.deleteTpm(e.tpm_id)}}},[r("span",{staticClass:"material-icons"},[t._v(" clear ")])])])])})),0)])])]),t._v(" "),r("div",{},[t._m(3),t._v(" "),r("div",{staticClass:"flex items-end"},[r("div",{staticClass:"mr-2 flex items-end"},[t.in_insert_serv?r("custom-input",{attrs:{label:"Service ... "},model:{value:t.tps_model.service_label,callback:function(e){t.$set(t.tps_model,"service_label",e)},expression:"tps_model.service_label"}}):r("c-select",{attrs:{placeholder:"Service ...",datas:t.services,label:"t_serv_label",code:"t_serv_id"},model:{value:t.tps_model.service_id,callback:function(e){t.$set(t.tps_model,"service_id",e)},expression:"tps_model.service_id"}}),t._v(" "),r("button",{staticClass:"p-1 border rounded-full justify-center items-center w-10 h-10 flex bg-gray-50 ml-2",on:{click:function(){t.in_insert_serv&&t.services.length>0?(t.in_insert_serv=!1,t.tps_model.service_id=t.services[0].t_serv_id,t.tps_model.service_label=""):(t.in_insert_serv=!0,t.tps_model.service_label="service",t.tps_model.service_id=null)}}},[r("span",{staticClass:"material-icons"},[t._v(" edit ")])])],1),t._v(" "),r("c-select",{staticClass:"mr-2",attrs:{label:"label",code:"code",datas:t.panel_impression_type,placeholder:"Type ..."},model:{value:t.tps_model.type,callback:function(e){t.$set(t.tps_model,"type",e)},expression:"tps_model.type"}}),t._v(" "),r("custom-input",{staticClass:"w-40 mr-2",attrs:{label:"Prix ..."},model:{value:t.tps_model.prix,callback:function(e){t.$set(t.tps_model,"prix",e)},expression:"tps_model.prix"}}),t._v(" "),r("button",{staticClass:" text-sm bt",on:{click:t.postTps}},[t._v(" Ajouter ")])],1),t._v(" "),t.tps.length<=0?r("div",{staticClass:" flex justify-center items-center p-2 text-sm "},[r("span",[t._v(" Aucun Service ajouter pour le moment ")])]):r("div",{staticClass:"w-full mt-2"},[r("table",{staticClass:"w-full"},[t._m(4),t._v(" "),r("tbody",t._l(t.tps,(function(e){return r("tr",{key:e.tps_id,staticClass:"border-b"},[r("td",{staticClass:"py-1 px-2"},[t._v(" "+t._s(e.t_serv_label)+" ")]),t._v(" "),r("td",{staticClass:"py-1 px-2"},[t._v(" "+t._s(e.tps_type)+" ")]),t._v(" "),r("td",{staticClass:"py-1 px-2"},[t._v(" "+t._s(e.tps_prix)+" ")]),t._v(" "),r("td",{staticClass:"py-1 px-2"},[r("button",{staticClass:"bt-prev-next",on:{click:function(r){return t.deleteTps(e.tps_id)}}},[r("span",{staticClass:"material-icons"},[t._v(" clear ")])])])])})),0)])])])]):t._e()])}),[function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("div",[r("span",{staticClass:"text-xs font-bold"},[t._v(" Choisissez d'abord le régisseur, catégorie et format ... ")])])},function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("div",{staticClass:"text-sm py-2 underline"},[r("span",{staticClass:"font-bold"},[t._v(" Les services par mois ... ")])])},function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("thead",[r("tr",{staticClass:"p-2 text-left border"},[r("th",{staticClass:"p-2"},[t._v(" Nombre de mois ")]),t._v(" "),r("th",{staticClass:"p-2"},[t._v(" Taxe Communale ")]),t._v(" "),r("th",{staticClass:"p-2"},[t._v(" Location ")]),t._v(" "),r("th",{staticClass:"p-2"},[t._v(" Action ")])])])},function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("div",{staticClass:"mb-2 py-2 underline"},[r("span",{staticClass:" text-sm font-bold "},[t._v(" Les autres services  ")])])},function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("thead",[r("tr",{staticClass:"p-2 text-left border"},[r("th",{staticClass:"p-2"},[t._v(" Service ")]),t._v(" "),r("th",{staticClass:"p-2"},[t._v(" Type ")]),t._v(" "),r("th",{staticClass:"p-2"},[t._v(" Prix ")])])])}],!1,null,null,null);e.default=component.exports;installComponents(component,{CSelect:r(362).default,CustomInput:r(358).default})}}]);