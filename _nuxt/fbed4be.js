(window.webpackJsonp=window.webpackJsonp||[]).push([[186,17,23,47],{358:function(e,t,n){"use strict";n.r(t);var l={props:["label","type","id","autofocus","width","value"],data:function(){return{on_focus:!1,style:{height:40},input:{style:{},model:""}}},methods:{updateInput:function(){this.$emit("input",this.$refs.cinput.value)},focusInput:function(){this.$refs.cinput.focus()}},mounted:function(){},created:function(){}},o=n(7),component=Object(o.a)(l,(function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{style:e.input.style},[n("div",{staticClass:"text-xs duration-300 flex items-center font-bold h-4"},[n("label",{staticClass:"z-10 px-1 text-indigo-600",attrs:{for:e.id}},[e._v(" "+e._s(e.label)+" ")])]),e._v(" "),n("input",{ref:"cinput",staticClass:"input-alt w-full duration-300 text-xs",attrs:{autofocus:e.autofocus,id:e.id,type:e.type,placeholder:e.label},domProps:{value:e.value},on:{input:function(t){return e.updateInput()},focus:function(){e.on_focus=!0,e.$emit("focus")},blur:function(){e.on_focus=!1,e.$emit("blur")}}})])}),[],!1,null,"a221d83e",null);t.default=component.exports},359:function(e,t,n){var content=n(361);content.__esModule&&(content=content.default),"string"==typeof content&&(content=[[e.i,content,""]]),content.locals&&(e.exports=content.locals);(0,n(27).default)("2d1dc0a2",content,!0,{sourceMap:!1})},360:function(e,t,n){"use strict";n(359)},361:function(e,t,n){var l=n(26)((function(i){return i[1]}));l.push([e.i,"/*purgecss start ignore*/\n.fade-enter-active,.fade-leave-active{\n  transition:opacity .3s\n}\n.fade-enter,.fade-leave-to{\n  opacity:0\n}\n\n/*purgecss end ignore*/",""]),l.locals={},e.exports=l},362:function(e,t,n){"use strict";n.r(t);var l={props:["value","datas","label","code","placeholder","padding","width"],watch:{datas:function(a){this.$emit("input",void 0===a[0]?null:a[0][this.code])}},data:function(){return{}},methods:{updateInput:function(){this.$emit("input",this.$refs.cinput.value)}},mounted:function(){}},o=(n(360),n(7)),component=Object(o.a)(l,(function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"relative flex flex-col"},[e.placeholder?n("div",{staticClass:"text-xs duration-300 flex items-center font-bold",class:e.datas.length>0?" h-4":"h-0"},[e.datas.length>0?n("label",{staticClass:"z-10 px-1 text-indigo-600"},[e._v(" "+e._s(e.placeholder)+" ")]):e._e()]):e._e(),e._v(" "),n("div",[n("select",{ref:"cinput",staticClass:"input-alt w-full duration-300 text-xs",on:{change:function(t){return e.updateInput()}}},e._l(e.datas,(function(t){return n("option",{key:t[e.code],domProps:{value:t[e.code],selected:e.value==t[void 0===e.code?"code":e.code]}},[e._v(" "+e._s(t[void 0===e.label?"label":e.label])+" ")])})),0)])])}),[],!1,null,null,null);t.default=component.exports},364:function(e,t,n){var content=n(367);content.__esModule&&(content=content.default),"string"==typeof content&&(content=[[e.i,content,""]]),content.locals&&(e.exports=content.locals);(0,n(27).default)("66a93922",content,!0,{sourceMap:!1})},366:function(e,t,n){"use strict";n(364)},367:function(e,t,n){var l=n(26)((function(i){return i[1]}));l.push([e.i,"/*purgecss start ignore*/\n.leaflet-popup .leaflet-popup-content-wrapper{\n  background-color:transparent;\n  box-shadow:none;\n  padding:0\n}\n.leaflet-popup .leaflet-popup-content{\n  width:200px;\n  padding:0\n}\n.leaflet-popup .leaflet-popup-tip-container{\n  top:0;\n  display:none\n}\n\n/*purgecss end ignore*/",""]),l.locals={},e.exports=l},370:function(e,t,n){"use strict";n.r(t);var l=n(3),o=(n(25),n(37),n(61),n(56),n(373),n(374),{}),r={props:["list_coord","load_data"],watch:{load_data:function(a){a&&this.initMap()}},data:function(){return{mymap:{},accessToken:"pk.eyJ1IjoiYW5nZWxvMTQyNyIsImEiOiJja3c0aGExMTIwNmp0Mm9udnY2bGNsZnRoIn0.PiJCKKLMoWzmULCaFs2CqA",layerGroup:{},markers:{},index_selected:-1}},methods:{setLinkPan:function(){return"r-panneau"==this.$route.name?"r/":"a-panneau"==this.$route.name?"a/":"admin-panneau"==this.$route.name?"admin/":""},initMap:function(){var e=this;return Object(l.a)(regeneratorRuntime.mark((function t(){var n,i,l;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:for(e.mymap=o.map("map",{zoomControl:!0}).setView([-19.002846,46.460938],5),o.tileLayer("https://api.mapbox.com/styles/v1/{id}/tiles/{z}/{x}/{y}?access_token={accessToken}",{attribution:'Map data &copy; <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors, Imagery © <a href="https://www.mapbox.com/">Mapbox</a>',maxZoom:18,id:"mapbox/streets-v11",tileSize:512,zoomOffset:-1,accessToken:"pk.eyJ1IjoiYW5nZWxvMTQyNyIsImEiOiJja3c0aGExMTIwNmp0Mm9udnY2bGNsZnRoIn0.PiJCKKLMoWzmULCaFs2CqA"}).addTo(e.mymap),e.markers=new o.MarkerClusterGroup({iconCreateFunction:function(e){var html='<div style="font-family: \'Roboto Mono\';" class="flex duration-300 hover:w-14 hover:h-14 justify-center rounded-full text-lg items-center bg-opacity-30 bg-indigo-600 w-12 h-12">';return html+='<div class="bg-indigo-600 h-10 w-10 text-gray-100 flex rounded-full justify-center items-center font-bold">'+e.getAllChildMarkers().length+"</div>",html+="</div>",o.divIcon({html:html,className:"mycluster",iconSize:o.point(32,32)})}}),n=function(i){var t=e.list_coord[i];l='<div style="font-family: \'Roboto Mono\';" class="flex duration-300 hover:w-14 hover:h-14 justify-center rounded-full text-lg items-center bg-opacity-10 bg-indigo-600 w-12 h-12">',l+='<span class="material-icons duration-300 text-indigo-600 hover:text-indigo-900 " style="font-size:50px;color:'.concat(t.cat_color,'"> place </span>'),l+="</div>",'<div style="font-family: \'Roboto Mono\';" class="flex duration-300 hover:w-14 hover:h-14 justify-center rounded-full text-lg items-center bg-opacity-10 bg-indigo-600 w-12 h-12">','<span class="material-icons duration-300 text-red-600 hover:text-red-900 " style="font-size:50px;"> place </span>',"</div>";var n=o.divIcon({className:"custom-div-icon",html:l,iconSize:[30,42],iconAnchor:[30,35],popupAnchor:[0,-30]}),r=o.divIcon({className:"custom-div-icon",html:'<div style="font-family: \'Roboto Mono\';" class="flex duration-300 hover:w-14 hover:h-14 justify-center rounded-full text-lg items-center bg-opacity-10 bg-indigo-600 w-12 h-12"><span class="material-icons duration-300 text-red-600 hover:text-red-900 " style="font-size:50px;"> place </span></div>',iconSize:[30,42],iconAnchor:[30,35],popupAnchor:[0,-30]}),c=o.marker([t.lieu_lat,t.lieu_lng],{icon:n});e.mymap.on("click",(function(){e.index_selected=-1,e.markers.eachLayer((function(e){e.setIcon(n)}))}));var d=e;c.on("click",(function(){d.markers.eachLayer((function(e){e.setIcon(n)})),d.index_selected=i,this.setIcon(r)})),e.markers.addLayer(c)},i=0;i<e.list_coord.length;i++)n(i);e.mymap.addLayer(e.markers);case 6:case"end":return t.stop()}}),t)})))()}},mounted:function(){var e=this;o=n(363),n(375),this.load_data&&setTimeout((function(){e.initMap()}),500)}},c=(n(366),n(7)),component=Object(c.a)(r,(function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"relative",staticStyle:{height:"500px",width:"100%"}},[n("div",{staticStyle:{height:"100%",width:"100%","border-radius":"8px"},attrs:{id:"map"}}),e._v(" "),n("div",{staticClass:"bg-gray-100 flex w-72 rounded-lg absolute top-5 right-5 duration-300",class:-1==e.index_selected?"h-16":"h-48",staticStyle:{"z-index":"1002"}},[-1!=e.index_selected?n("div",{staticClass:"cursor-pointer p-2 flex w-full relative flex-col justify-start items-start",on:{click:function(){"a-search-place"==e.$route.name?e.$router.push("/a/search-place/"+e.list_coord[e.index_selected].pan_id):e.$router.push("/"+e.setLinkPan()+"panneau/"+e.list_coord[e.index_selected].pan_id)}}},[n("div",{staticClass:"flex absolute top-4 left-4"},[n("span",{staticClass:"p-2 rounded-full bg-indigo-600 text-white"},[e._v(" "+e._s(e.list_coord[e.index_selected].pan_publoc_ref)+" ")])]),e._v(" "),null!=e.list_coord[e.index_selected].name_file?n("div",{staticClass:"h-full w-full flex rounded-t"},[n("img",{staticClass:"object-cover flex-grow rounded",attrs:{src:"/api/p/media/"+e.list_coord[e.index_selected].name_min_file,loading:"lazy",crossorigin:"anonymous"}})]):e._e(),e._v(" "),n("div",{staticClass:"flex justify-end items-end font-bold absolute p-2 w-full h-16 bg-gradient-to-t rounded-b-lg from-gray-700 to-transparent via-gray-700 left-0 bottom-0"},[n("span",{staticClass:"py-2 text-gray-200 block w-full"},[e._v(" "+e._s(e.list_coord[e.index_selected].lieu_label)+" ")])])]):n("div",{staticClass:"p-2 flex justify-center items-center text-gray-400"},[n("span",[e._v(" Cliquez sur un marqueur pour plus de détails ")])])])])}),[],!1,null,null,null);t.default=component.exports},539:function(e,t,n){"use strict";n.r(t);var l=n(3),o=(n(25),n(47),n(13),{watch:{"filter.search":function(a){this.getPanel()},"filter.by":function(a){this.getPanel()}},data:function(){return{panels:[],label_list:[{label:"Ref. Régisseur",key:"pan_ref"},{label:"Régisseur",key:"reg_label"},{label:"Annonceur",key:"ann_label"},{label:"Catégorie",key:"parent_cat_label"},{label:"Format",key:"cat_label"},{label:"Date de début",key:"spp_date_debut"},{label:"Date de Fin",key:"spp_date_fin"},{label:"Date de Contrôle",key:"spp_date_control"},{label:"Type",key:"spp_type"},{label:"Nb. Photo",key:"pan_list_photo_solarpro"},{label:"Nb. Lumière",key:"spp_nb_light"}],cur_view:"liste",loaded:!1,pop_up:{id:null},filter:{search:"",by:"pan_ref"},nb_light_total:0,search_label_select:[{label:"Ref. Régisseur",code:"pan_ref"},{label:"Régisseur",code:"reg_label"},{label:"Annonceur",code:"ann_label"}]}},methods:{getPanel:function(){var e=this;return Object(l.a)(regeneratorRuntime.mark((function t(){var n;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e.loaded=!1,t.prev=1,t.next=4,e.$axios.$get("api/a/solarpro/panel",{params:e.filter});case 4:(n=t.sent).status?(e.panels=n.panels,e.nb_light_total=n.nb_light_total,e.loaded=!0):e.showNotif("Erreur",n.message,!0),t.next=11;break;case 8:t.prev=8,t.t0=t.catch(1),e.showErrorConnexion();case 11:case"end":return t.stop()}}),t,null,[[1,8]])})))()}},mounted:function(){this.getPanel()}}),r=n(7),component=Object(r.a)(o,(function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"w-full flex flex-col"},[n("div",{staticClass:"m-2 border rounded-lg p-2 flex items-end sticky top-5 bg-white z-30 shadow-lg"},[n("button",{staticClass:"bt-prev-next",on:{click:e.getPanel}},[n("span",{staticClass:"material-icons"},[e._v("refresh")])]),e._v(" "),n("div",{staticClass:"ml-2"},[n("span",{},[e._v(" Total : "+e._s(e.panels.length)+" ")])]),e._v(" "),n("div",{staticClass:"ml-2 flex items-end"},[n("custom-input",{attrs:{label:"Recherche ... "},model:{value:e.filter.search,callback:function(t){e.$set(e.filter,"search",t)},expression:"filter.search"}}),e._v(" "),n("c-select",{staticClass:"ml-2",attrs:{placeholder:"Par ...",datas:e.search_label_select,label:"label",code:"code"},model:{value:e.filter.by,callback:function(t){e.$set(e.filter,"by",t)},expression:"filter.by"}})],1),e._v(" "),n("span",{staticClass:"flex-grow"}),e._v(" "),n("div",{},[n("div",{staticClass:"flex border rounded"},[n("button",{staticClass:"p-2 bg-gray-50 hover:bg-gray-100 flex justify-center items-center rounded-l",class:"carte"==e.cur_view?"bg-indigo-600 hover:bg-indigo-600 text-white":"",on:{click:function(t){e.cur_view="carte"}}},[n("span",{staticClass:"material-icons"},[e._v(" place ")])]),e._v(" "),n("button",{staticClass:"p-2 bg-gray-50 hover:bg-gray-100 rounded-r flex justify-center items-center",class:"liste"==e.cur_view?"bg-indigo-600 hover:bg-indigo-600 text-white":"",on:{click:function(t){e.cur_view="liste"}}},[n("span",{staticClass:"material-icons"},[e._v(" list  ")])])])])]),e._v(" "),e.panels.length>0?n("div",{},["liste"==e.cur_view?n("div",{staticClass:"p-2 border rounded-lg m-2 text-sm"},[n("table",{staticClass:"w-full text-left table-auto "},[n("thead",{staticClass:"rounded-t"},[n("tr",{staticClass:"bg-gray-50 text-gray-700"},e._l(e.label_list,(function(t){return n("th",{key:t.key,staticClass:"p-2"},[e._v(" "+e._s(t.label)+" ")])})),0)]),e._v(" "),n("tbody",[e._l(e.panels,(function(p){return n("tr",{key:p.pan_id,staticClass:"border-b"},e._l(e.label_list,(function(t){return n("td",{key:t.key,staticClass:"p-2 relative",class:{" bg-yellow-300 bg-opacity-20":t.key==e.filter.by&&e.filter.search,"border border-red-300 bg-opacity-10":e.dateDiff(new Date,new Date(p.spp_date_fin)).day<5&&"spp_date_fin"==t.key}},["pan_ref"==t.key?n("nuxt-link",{staticClass:"underline hover:text-gray-600",attrs:{to:"/solarpro/"+p.pan_id}},[e._v(" "+e._s(p.pan_ref)+" ")]):"date"==t.key.split("_")[1]?n("div",{staticClass:"flex flex-col"},[n("span",{},[e._v(e._s(p[t.key]?new Date(p[t.key]).toLocaleDateString():"-"))]),e._v(" "),p[t.key]&&"spp_date_fin"==t.key?n("span",{staticClass:"text-xs"},[e._v(" Expire dans "+e._s(e.dateDiff(new Date,new Date(p[t.key])).day)+" jrs ")]):e._e()]):"pan_list_photo_solarpro"==t.key?n("span",{},[e._v(" "+e._s(p[t.key]?p[t.key].split(",").length:0)+" ")]):"spp_type"==t.key?n("span",{},[e._v(" "+e._s(e._f("capitalising")(p.spp_type?p.spp_type:"-"))+" ")]):n("span",{},[e._v(" "+e._s(p[t.key]?p[t.key]:"-")+"  ")])],1)})),0)})),e._v(" "),n("tr",{staticClass:"border sticky bottom-5 bg-white shadow-lg"},[n("td",{staticClass:"p-2",attrs:{colspan:e.label_list.length-1}},[e._v("Total lumière")]),e._v(" "),n("td",{staticClass:"p-2"},[e._v(" "+e._s(e.nb_light_total)+" ")])])],2)])]):e._e(),e._v(" "),"carte"==e.cur_view?n("div",{staticClass:"m-2"},[n("client-only",[n("map-accueil",{attrs:{list_coord:e.panels,load_data:e.loaded}})],1)],1):e._e()]):n("div",{staticClass:"m-5 flex justify-center items-center"},[n("div",{staticClass:"flex rounded-lg border p-2 "},[n("span",{staticClass:"text-gray-600"},[e._v(" Solarpro n'a aucun accès à aucun panneau pour le moment ")]),e._v(" "),n("button",{staticClass:"bt-prev-next",on:{click:e.getPanel}},[n("span",{staticClass:"material-icons"},[e._v("refresh")])])])])])}),[],!1,null,null,null);t.default=component.exports;installComponents(component,{CustomInput:n(358).default,CSelect:n(362).default,MapAccueil:n(370).default})}}]);