(window.webpackJsonp=window.webpackJsonp||[]).push([[190,17,23,32],{358:function(t,e,r){"use strict";r.r(e);var n={props:["label","type","id","autofocus","width","value"],data:function(){return{on_focus:!1,style:{height:40},input:{style:{},model:""}}},methods:{updateInput:function(){this.$emit("input",this.$refs.cinput.value)},focusInput:function(){this.$refs.cinput.focus()}},mounted:function(){},created:function(){}},o=r(7),component=Object(o.a)(n,(function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("div",{style:t.input.style},[r("div",{staticClass:"text-xs duration-300 flex items-center font-bold h-4"},[r("label",{staticClass:"z-10 px-1 text-indigo-600",attrs:{for:t.id}},[t._v(" "+t._s(t.label)+" ")])]),t._v(" "),r("input",{ref:"cinput",staticClass:"input-alt w-full duration-300 text-xs",attrs:{autofocus:t.autofocus,id:t.id,type:t.type,placeholder:t.label},domProps:{value:t.value},on:{input:function(e){return t.updateInput()},focus:function(){t.on_focus=!0,t.$emit("focus")},blur:function(){t.on_focus=!1,t.$emit("blur")}}})])}),[],!1,null,"a221d83e",null);e.default=component.exports},359:function(t,e,r){var content=r(361);content.__esModule&&(content=content.default),"string"==typeof content&&(content=[[t.i,content,""]]),content.locals&&(t.exports=content.locals);(0,r(27).default)("2d1dc0a2",content,!0,{sourceMap:!1})},360:function(t,e,r){"use strict";r(359)},361:function(t,e,r){var n=r(26)((function(i){return i[1]}));n.push([t.i,"/*purgecss start ignore*/\n.fade-enter-active,.fade-leave-active{\n  transition:opacity .3s\n}\n.fade-enter,.fade-leave-to{\n  opacity:0\n}\n\n/*purgecss end ignore*/",""]),n.locals={},t.exports=n},362:function(t,e,r){"use strict";r.r(e);var n={props:["value","datas","label","code","placeholder","padding","width"],watch:{datas:function(a){this.$emit("input",void 0===a[0]?null:a[0][this.code])}},data:function(){return{}},methods:{updateInput:function(){this.$emit("input",this.$refs.cinput.value)}},mounted:function(){}},o=(r(360),r(7)),component=Object(o.a)(n,(function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("div",{staticClass:"relative flex flex-col"},[t.placeholder?r("div",{staticClass:"text-xs duration-300 flex items-center font-bold",class:t.datas.length>0?" h-4":"h-0"},[t.datas.length>0?r("label",{staticClass:"z-10 px-1 text-indigo-600"},[t._v(" "+t._s(t.placeholder)+" ")]):t._e()]):t._e(),t._v(" "),r("div",[r("select",{ref:"cinput",staticClass:"input-alt w-full duration-300 text-xs",on:{change:function(e){return t.updateInput()}}},t._l(t.datas,(function(e){return r("option",{key:e[t.code],domProps:{value:e[t.code],selected:t.value==e[void 0===t.code?"code":t.code]}},[t._v(" "+t._s(e[void 0===t.label?"label":t.label])+" ")])})),0)])])}),[],!1,null,null,null);e.default=component.exports},391:function(t,e,r){"use strict";var n=r(4),o=r(6),l=r(57),c=r(39),d=r(48),_=r(15),f=r(5),h=r(231),v=r(159),m=r(392),x=r(393),C=r(100),y=r(394),w=[],k=o(w.sort),P=o(w.push),$=f((function(){w.sort(void 0)})),R=f((function(){w.sort(null)})),E=v("sort"),j=!f((function(){if(C)return C<70;if(!(m&&m>3)){if(x)return!0;if(y)return y<603;var code,t,e,r,n="";for(code=65;code<76;code++){switch(t=String.fromCharCode(code),code){case 66:case 69:case 70:case 72:e=3;break;case 68:case 71:e=4;break;default:e=2}for(r=0;r<47;r++)w.push({k:t+r,v:e})}for(w.sort((function(a,b){return b.v-a.v})),r=0;r<w.length;r++)t=w[r].k.charAt(0),n.charAt(n.length-1)!==t&&(n+=t);return"DGBEFHACIJK"!==n}}));n({target:"Array",proto:!0,forced:$||!R||!E||!j},{sort:function(t){void 0!==t&&l(t);var e=c(this);if(j)return void 0===t?k(e):k(e,t);var r,n,o=[],f=d(e);for(n=0;n<f;n++)n in e&&P(o,e[n]);for(h(o,function(t){return function(e,r){return void 0===r?-1:void 0===e?1:void 0!==t?+t(e,r)||0:_(e)>_(r)?1:-1}}(t)),r=o.length,n=0;n<r;)e[n]=o[n++];for(;n<f;)delete e[n++];return e}})},392:function(t,e,r){var n=r(83).match(/firefox\/(\d+)/i);t.exports=!!n&&+n[1]},393:function(t,e,r){var n=r(83);t.exports=/MSIE|Trident/.test(n)},394:function(t,e,r){var n=r(83).match(/AppleWebKit\/(\d+)\./);t.exports=!!n&&+n[1]},423:function(t,e,r){"use strict";r.r(e);var n=r(3),o=(r(25),{props:["reg_id","list_month"],data:function(){return{name_pdf:"",rapport_ann:!1,in_process:!1,text_head:"",type_portrait:[{label:"Portrait",code:1},{label:"Paysage",code:0}],isPrortrait:1}},methods:{exportPdf:function(){var t=this;return Object(n.a)(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,t.$axios.$post("api/a/solarpro/rapport/reg/"+t.reg_id+"/pdf",{titre:t.name_pdf,months:t.list_month,text_head:t.text_head,isPortrait:t.isPrortrait});case 3:e.sent.status&&t.$emit("validate"),e.next=10;break;case 7:e.prev=7,e.t0=e.catch(0),t.showErrorConnexion();case 10:case"end":return e.stop()}}),e,null,[[0,7]])})))()}},mounted:function(){}}),l=r(7),component=Object(l.a)(o,(function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("div",{staticClass:"flex justify-center items-center top-0 left-0 fixed w-screen h-screen bg-white bg-opacity-75 z-50"},[r("div",{staticClass:"bg-white rounded-lg border shadow-lg ",style:{width:"500px"}},[r("div",{staticClass:"p-2 flex border-b items-center"},[r("span",[t._v("  Exporter en PDF ")]),t._v(" "),r("span",{staticClass:"flex-grow"}),t._v(" "),r("button",{staticClass:"bt-back text-sm",on:{click:function(e){return t.$emit("close")}}},[t._v(" Retour ")])]),t._v(" "),r("div",{staticClass:"flex flex-col p-2"},[r("div",{staticClass:"flex items-end mb-2"},[r("custom-input",{attrs:{label:"Nom du pdf ..."},model:{value:t.name_pdf,callback:function(e){t.name_pdf=e},expression:"name_pdf"}})],1),t._v(" "),r("div",{staticClass:"mb-2 flex flex-col"},[r("span",{staticClass:"text-indigo-600 text-xs font-bold"},[t._v(" Texte en haut du pdf ... ")]),t._v(" "),r("textarea",{directives:[{name:"model",rawName:"v-model",value:t.text_head,expression:"text_head"}],staticClass:"input-alt",attrs:{name:"",id:"",cols:"30",rows:"10"},domProps:{value:t.text_head},on:{input:function(e){e.target.composing||(t.text_head=e.target.value)}}})]),t._v(" "),r("div",{staticClass:"flex"},[r("c-select",{attrs:{label:"label",code:"code",datas:t.type_portrait,placeholder:"Orientation du PDF ..."},model:{value:t.isPortrait,callback:function(e){t.isPortrait=e},expression:"isPortrait"}})],1)]),t._v(" "),r("div",{staticClass:"py-2"},[r("button",{staticClass:"bt text-xs ml-2",on:{click:t.exportPdf}},[t._v("Exporter")])]),t._v(" "),t.in_process?r("div",{staticClass:"p-2 border-t"},[r("span",{staticClass:"text-blue-500"},[t._v(" Travail en cours .........")])]):t._e()])])}),[],!1,null,null,null);e.default=component.exports;installComponents(component,{CustomInput:r(358).default,CSelect:r(362).default})},546:function(t,e,r){"use strict";r.r(e);var n=r(3),o=(r(156),r(391),r(25),{data:function(){return{have_data:!1,list_month:[],model_list_month:["Janvier","Février","Mars","Avril","Mai","Juin","Juillet","Août","Septembre","Octobre","Novembre","Décembre"],pan_rapport:[],count_month:{},count_light:{},on_export:!1,list_pdf:[]}},methods:{getRapportReg:function(){var t=this;return Object(n.a)(regeneratorRuntime.mark((function e(){var r;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,t.$axios.$get("api/a/solarpro/rapport/reg/"+t.$route.query.reg_id,{params:{months:t.list_month}});case 3:(r=e.sent).status?(t.pan_rapport=r.rapport,t.countPanelPerMonth()):t.showNotif("Erreur",r.message,!0),e.next=10;break;case 7:e.prev=7,e.t0=e.catch(0),t.showErrorConnexion();case 10:case"end":return e.stop()}}),e,null,[[0,7]])})))()},addMonth:function(i){var t=this.list_month.indexOf(i);-1!=t?this.list_month.splice(t,1):this.list_month.push(i),this.list_month.sort((function(a,b){return a-b}))},setSearch:function(){this.getRapportReg()},countPanelPerMonth:function(){for(var t=(new Date).getFullYear(),e=this.pan_rapport,r={},n=0,i=0;i<e.length;i++){(r=e[i]).year_begin<t&&(r.month_begin=1),r.year_end>t&&(r.month_end=12);for(var o=0;o<this.model_list_month.length;o++)(n=o+1)<=r.month_end&&n>=r.month_begin&&(this.count_month[n]=null!=this.count_month[n]?this.count_month[n]+1:1,this.count_light[n]=null!=this.count_light[n]?this.count_light[n]+r.spp_nb_light:r.spp_nb_light)}},getListPDF:function(){var t=this;return Object(n.a)(regeneratorRuntime.mark((function e(){var r;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,t.$axios.$get("api/a/solarpro/rapport/list/pdf/reg/"+t.$route.query.reg_id);case 3:(r=e.sent).status&&(t.list_pdf=r.list_pdf),e.next=10;break;case 7:e.prev=7,e.t0=e.catch(0),t.showErrorConnexion();case 10:case"end":return e.stop()}}),e,null,[[0,7]])})))()},generatePDF:function(){var t=this;return Object(n.a)(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(t.list_month.length<=0)){e.next=2;break}return e.abrupt("return");case 2:t.on_export=!0;case 3:case"end":return e.stop()}}),e)})))()},generateReport:function(){this.$refs.html2Pdf.generatePdf()},deleteRapport:function(t){var e=this;return Object(n.a)(regeneratorRuntime.mark((function r(){var n;return regeneratorRuntime.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return r.prev=0,r.next=3,e.$axios.$delete("api/a/solarpro/rapport/"+t);case 3:(n=r.sent).status?e.getListPDF():e.showNotif("Erreur",n.message,!0),r.next=10;break;case 7:r.prev=7,r.t0=r.catch(0),e.showErrorConnexion();case 10:case"end":return r.stop()}}),r,null,[[0,7]])})))()}},beforeMount:function(){this.have_data=!!this.$route.query.reg_id},mounted:function(){this.setSearch(),this.getListPDF()}}),l=r(7),component=Object(l.a)(o,(function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("div",{},[t.have_data?r("div",{},[r("div",{staticClass:"p-2 border-b flex justify-center items-center"},[r("span",[t._v(" Choisissez les mois ")]),t._v(" "),r("div",{staticClass:"mx-2 p-1 border-l"},[r("button",{class:{bt:t.list_month.length,"bt-load":!t.list_month.length},on:{click:t.generatePDF}},[t._v("Génerer PDF")])])]),t._v(" "),r("div",{staticClass:" flex flex-wrap mb-2 border-b p-2"},t._l(t.model_list_month,(function(e,i){return r("div",{key:e,staticClass:"m-1 p-2 border rounded items-center justify-center flex"},[r("input",{attrs:{type:"checkbox",id:"check_month_"+i,name:"check_month_"+i},on:{click:function(e){return t.addMonth(i+1)}}}),t._v(" "),r("label",{staticClass:"ml-1",attrs:{for:"check_month_"+i}},[t._v(" "+t._s(e)+" ")])])})),0),t._v(" "),t.list_month.length>0?r("div",{},[r("table",{},[r("thead",{staticClass:"rounded-t sticky top-0 z-20"},[r("tr",{staticClass:"bg-gray-50 text-gray-700"},[r("th",{staticClass:"p-2"},[t._v(" Ref ")]),t._v(" "),r("th",{staticClass:"p-2"},[t._v(" Annonceur ")]),t._v(" "),r("th",{staticClass:"p-2"},[t._v(" Nb. Lumière ")]),t._v(" "),t._l(t.list_month,(function(e){return r("th",{key:e,staticClass:"p-2 w-20"},[t._v(" "+t._s(t.model_list_month[parseInt(e)-1])+" ")])}))],2)]),t._v(" "),r("tbody",[t._l(t.pan_rapport,(function(p){return r("tr",{key:p.pan_id,staticClass:"border-b"},[r("td",{staticClass:"p-2 border relative"},[t._v(" "+t._s(p.pan_ref)+" ")]),t._v(" "),r("td",{staticClass:"p-2 border relative"},[t._v(" "+t._s(p.ann_label)+" ")]),t._v(" "),r("td",{staticClass:"p-2 border relative"},[t._v(" "+t._s(p.spp_nb_light)+" ")]),t._v(" "),t._l(t.list_month,(function(li){return r("td",{key:li,staticClass:"p-2 border"},[r("span",{staticClass:"flex rounded p-2 w-full h-full",class:{"bg-blue-500 border border-blue-500":li<=p.month_end&&li>=p.month_begin}})])}))],2)})),t._v(" "),r("tr",{staticClass:"shadow-lg font-bold sticky bottom-12 bg-white border"},[r("td",{staticClass:" p-2 border"},[t._v(" Total Emplacements ")]),t._v(" "),r("td",{staticClass:"p-2 border"}),t._v(" "),r("td",{staticClass:"p-2 border"}),t._v(" "),t._l(t.list_month,(function(e){return r("td",{key:e,staticClass:"border"},[r("span",{staticClass:"p-2"},[t._v(" "+t._s(t.count_month[e])+" ")])])}))],2),t._v(" "),r("tr",{staticClass:"shadow-lg font-bold sticky bottom-2 bg-white border"},[r("td",{staticClass:" p-2 border"},[t._v(" Total Lumière ")]),t._v(" "),r("td",{staticClass:"p-2 border"}),t._v(" "),r("td",{staticClass:"p-2 border"}),t._v(" "),t._l(t.list_month,(function(e){return r("td",{key:e,staticClass:"border"},[r("span",{staticClass:"p-2"},[t._v(" "+t._s(t.count_light[e])+" ")])])}))],2)],2)])]):t._e(),t._v(" "),r("div",{staticClass:"mt-2"},[r("div",{},[r("table",[t._m(0),t._v(" "),r("tbody",t._l(t.list_pdf,(function(p){return r("tr",{key:p.rapport_id,staticClass:"p-2 border"},[r("td",{staticClass:"p-2"},[r("a",{attrs:{target:"_blank",href:"/api/a/pdf/view/"+p.rapport_name}},[t._v(" "+t._s(p.rapport_title)+" ")])]),t._v(" "),r("td",{staticClass:"p-2"},[r("button",{staticClass:"bt-prev-next",on:{click:function(e){return t.deleteRapport(p.rapport_id)}}},[r("span",{staticClass:"material-icons"},[t._v("clear")])])])])})),0)])])])]):r("div",{staticClass:" w-full m-5 flex justify-center items-center "},[r("span",{},[t._v(" Aucun regisseur séléctionné ")])]),t._v(" "),t.on_export?r("export-pdf-reg",{attrs:{reg_id:t.$route.query.reg_id,list_month:t.list_month},on:{validate:function(){t.on_export=!1,t.getListPDF()},close:function(e){t.on_export=!1}}}):t._e()],1)}),[function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("thead",[r("tr",[r("th",{staticClass:"p-2 border bg-gray-50 text-gray-700"},[t._v(" Liste PDF ")]),t._v(" "),r("th",{staticClass:"p-2 border bg-gray-50 text-gray-700"},[t._v(" Suppression ")])])])}],!1,null,null,null);e.default=component.exports;installComponents(component,{ExportPdfReg:r(423).default})}}]);