(window.webpackJsonp=window.webpackJsonp||[]).push([[125],{575:function(e,t,n){"use strict";n.r(t);var r=n(3),o=(n(25),n(61),n(21),n(99),n(37),n(156),{watch:{show_previz:function(a){this.cur_im=a?this.pub_ann.pub_im_list[0]:null}},data:function(){return{pub_ann:{pub_type:"ann_vert",pub_im_list:[]},on_load:!1,show_previz:!1,cur_im:null}},computed:{im_pub_style:function(){if(!this.cur_im)return{};var e=this.cur_im.dimension_file.split(",").map((function(e){return parseInt(e)})),s={};return e[1]>window.innerHeight&&(s.height="".concat(window.innerHeight,"px"),s.width="".concat(window.innerHeight/e[1]*e[0],"px")),s}},methods:{getListPubVertAnn:function(){var e=this;return Object(r.a)(regeneratorRuntime.mark((function t(){var n;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,e.$axios.$get("api/a/pub",{params:{type:e.pub_ann.pub_type}});case 3:(n=t.sent).status?e.pub_ann.pub_im_list=n.pub_im_list:e.showNotif("Erreur",n.message,!0),t.next=10;break;case 7:t.prev=7,t.t0=t.catch(0),e.showErrorConnexion();case 10:case"end":return t.stop()}}),t,null,[[0,7]])})))()},add_im:function(e){var t=this;return Object(r.a)(regeneratorRuntime.mark((function n(){var r;return regeneratorRuntime.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return t.on_load=!0,n.next=3,t.up_image(e);case 3:if(!(r=n.sent).status){n.next=9;break}return t.pub_ann.pub_im_list.push({dimension_min_file:r.opt.dim_min_file,dimension_file:r.opt.dim_file,file_id:r.file_id,name_file:r.opt.name,name_min_file:r.opt.name+"_min"}),n.next=8,t.addOrUpdatePub();case 8:t.on_load=!1;case 9:case"end":return n.stop()}}),n)})))()},addOrUpdatePub:function(){var e=this;return Object(r.a)(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,e.$axios.post("api/a/pub/type",e.pub_ann);case 3:t.sent.status,t.next=10;break;case 7:t.prev=7,t.t0=t.catch(0),e.showErrorConnexion();case 10:case"end":return t.stop()}}),t,null,[[0,7]])})))()},del_im:function(i){var e=this;return Object(r.a)(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.del_im_pub(e.pub_ann.pub_im_list[i].file_id);case 2:return e.pub_ann.pub_im_list.splice(i,1),t.next=5,e.addOrUpdatePub();case 5:case"end":return t.stop()}}),t)})))()},del_im_pub:function(e){var t=this;return Object(r.a)(regeneratorRuntime.mark((function n(){var r;return regeneratorRuntime.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.prev=0,n.next=3,t.$axios.$delete("api/a/pub/im/"+e);case 3:(r=n.sent).status||t.showNotif("Erreur",r.message,!0),n.next=10;break;case 7:n.prev=7,n.t0=n.catch(0),t.showErrorConnexion();case 10:case"end":return n.stop()}}),n,null,[[0,7]])})))()}},mounted:function(){this.getListPubVertAnn()}}),c=n(7),component=Object(c.a)(o,(function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{},[n("div",{staticClass:"mt-2 p-2"},[e._m(0),e._v(" "),n("div",{staticClass:"flex"},[e._l(e.pub_ann.pub_im_list,(function(t,i){return n("div",{key:t.file_id,staticClass:"relative w-28 h-28 rounded-lg flex justify-center items-center overflow-hidden bg-gray-50 border hover:border-indigo-600 m-2"},[t.name_file?n("img",{staticStyle:{width:"112px"},attrs:{src:"/api/p/media/"+t.name_file+"_min",alt:"",srcset:""}}):n("span",{staticClass:"text-6xl  material-icons"},[e._v(" perm_media ")]),e._v(" "),n("button",{staticClass:" top-1 right-1 absolute bt-prev-next text-xs",on:{click:function(t){return e.del_im(i)}}},[n("span",{staticClass:"material-icons"},[e._v(" clear ")])])])})),e._v(" "),e.on_load?n("div",{staticClass:"cursor-pointer  flex-col  w-28 h-28 rounded-lg flex justify-center items-center overflow-hidden bg-gray-50 border hover:border-indigo-600 m-2"},[n("span",{staticClass:"material-icons text-6xl animate-pulse text-indigo-500"},[e._v(" hourglass_bottom ")]),e._v(" "),n("span",{staticClass:" text-indigo-500 text-xs"},[e._v("Upload ...")])]):e._e(),e._v(" "),n("div",{},[e._m(1),e._v(" "),n("input",{staticClass:"hidden",attrs:{accept:"image/*",id:"im",type:"file"},on:{change:function(t){return e.add_im(t)}}})])],2),e._v(" "),0!=e.pub_ann.pub_im_list.length?n("div",{},[n("button",{staticClass:"bt text-sm",on:{click:function(t){e.show_previz=!0}}},[e._v(" Pr√©visualisation ")]),e._v(" "),e.show_previz?n("div",{staticClass:"fixed flex top-0 left-0 w-screen h-screen bg-white",staticStyle:{"z-index":"1010"}},[n("button",{staticClass:"bt-prev-next absolute top-5 left-5",on:{click:function(t){e.show_previz=!1}}},[n("span",{staticClass:"material-icons"},[e._v(" clear ")])]),e._v(" "),n("div",{staticClass:"flex-grow"}),e._v(" "),n("div",{staticClass:"border-l h-screen flex justify-center items-center",staticStyle:{width:"250px"}},[n("img",{style:e.im_pub_style,attrs:{src:"/api/p/media/"+e.cur_im.name_file,alt:""}})])]):e._e()]):e._e()])])}),[function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{},[n("span",{},[e._v(" Gestion pub de droite dans Annonceurs ")])])},function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("label",{staticClass:" cursor-pointer w-28 h-28 rounded-lg flex justify-center items-center overflow-hidden bg-gray-50 border hover:border-indigo-600 m-2",attrs:{for:"im"}},[n("span",{staticClass:"material-icons text-6xl"},[e._v(" add ")])])}],!1,null,null,null);t.default=component.exports}}]);