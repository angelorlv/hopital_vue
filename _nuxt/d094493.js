(window.webpackJsonp=window.webpackJsonp||[]).push([[130],{577:function(e,t,n){"use strict";n.r(t);var r=n(3),l=(n(156),n(25),{layout:"espace",watch:{cur_state:function(a){switch(a){case"list":this.$router.push({name:"admin-regisseur"}),this.getListReg();break;case"add":this.$router.push({name:"admin-regisseur",query:{st:"add"}})}},$route:function(e,t){return Object(r.a)(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}}),e)})))()}},data:function(){return{nb_reg:0,cur_state:"list",reg:{list:[]},label_list:[{label:"Nom de la société",width:200,key:"reg_label"},{label:"Adresse",width:170,key:"soc_pr_adresse"},{label:"Email",width:170,key:"soc_pr_email"},{label:"Nb. Panneau",width:130,key:"nb_panel"},{label:"Abonnée",width:90,key:"soc_sub"}],pan_selected_index_list:[]}},methods:{change_state:function(a){this.cur_state=a},getListReg:function(){var e=this;return Object(r.a)(regeneratorRuntime.mark((function t(){var n;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.$axios.$get("api/a/regisseur").then((function(a){return a}));case 2:(n=t.sent).status?e.reg.list=n.regisseurs:alert(n.message);case 4:case"end":return t.stop()}}),t)})))()},countReg:function(){var e=this;return Object(r.a)(regeneratorRuntime.mark((function t(){var n;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.$axios.$get("api/a/regisseur/count").then((function(a){return a}));case 2:(n=t.sent).status?e.nb_reg=n.nb:alert(n.message);case 4:case"end":return t.stop()}}),t)})))()},addSpliceSelected:function(i){var e=this.pan_selected_index_list.indexOf(i);-1==e?this.pan_selected_index_list.push(i):this.pan_selected_index_list.splice(e,1)},toggleCheck:function(e){if(this.pan_selected_index_list.length>0)this.pan_selected_index_list=[];else{var t=this.reg.list.length;this.pan_selected_index_list=[];for(var i=0;i<t;i++)this.pan_selected_index_list.push(i)}},viewPanel:function(e){this.$router.push({name:"admin-regisseur-id",params:{id:e}})},deleteMultipleReg:function(){var e=this;return Object(r.a)(regeneratorRuntime.mark((function t(){var n,r,l,i,c,o;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:for(n=[],r=0,l=e.pan_selected_index_list.length,i=0;i<l;i++)(c=e.reg.list[e.pan_selected_index_list[i]]).pan_loc_validate?r++:null==c.pan_loc_id&&n.push(c.reg_id);if(!confirm("Vous êtes sur de vouloir supprimer ces regisseurs ? A noter que seuls les regisseurs qui n'ont pas de panneau en cours de location qui seront supprimer. ("+r+") en cours de location, ("+n.length+") qui seront supprimer.")){t.next=15;break}return t.prev=3,t.next=6,e.$axios.$delete("api/a/ad/regisseur/m",{data:n});case 6:(o=t.sent).status?(e.getListReg(),e.pan_selected_index_list=[]):e.showNotif("Erreur",o.message,!0),t.next=13;break;case 10:t.prev=10,t.t0=t.catch(3),e.showErrorConnexion();case 13:t.next=16;break;case 15:return t.abrupt("return");case 16:case"end":return t.stop()}}),t,null,[[3,10]])})))()}},mounted:function(){this.getListReg(),this.countReg()}}),c=n(7),component=Object(c.a)(l,(function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{},[n("div",{staticClass:"flex w-full h-16 px-2 border-b sticky top-0 bg-white z-20"},[n("div",{staticClass:"flex justify-center w-full items-center"},[n("span",{staticClass:"text-2xl"},[e._v("Régisseur")]),e._v(" "),n("span",{staticClass:"text-xs p-1 px-3 rounded ml-1 flex  text-center bg-indigo-500 text-gray-100"},[e._v(e._s(e.nb_reg))]),e._v(" "),n("div",{staticClass:"flex-grow flex justify-center items-center"},[e.pan_selected_index_list.length>0?n("div",{},[n("button",{staticClass:"bt text-sm",on:{click:e.deleteMultipleReg}},[e._v(" Supprimer ")])]):e._e()]),e._v(" "),n("button",{staticClass:"bt text-sm flex justify-center items-center",on:{click:function(t){return e.$router.push({name:"admin-regisseur-add"})}}},[n("span",{staticClass:"material-icons"},[e._v(" add ")]),e._v(" "),n("span",[e._v("Ajouter un Régisseur")])])])]),e._v(" "),n("div",{staticClass:"flex mt-5 justify-center text-sm"},[n("div",{staticClass:"h-full"},[e.reg.list.length>0?n("div",{},[n("div",{staticClass:"flex flex-col  border rounded mb-2"},[n("div",{staticClass:"flex sticky  top-16 bg-gray-100 text-indigo-600"},[n("span",{staticClass:"font-bold border py-1 px-2 cursor-pointer w-8"},[n("input",{attrs:{type:"checkbox"},domProps:{checked:0!=e.pan_selected_index_list.length},on:{click:e.toggleCheck}})]),e._v(" "),e._l(e.label_list,(function(t){return n("span",{key:t.label,staticClass:"font-bold border py-1 px-2 cursor-pointer",style:{width:t.width+"px",minWidth:t.width+"px"}},[e._v(" "+e._s(t.label)+" ")])}))],2),e._v(" "),e._l(e.reg.list,(function(p,i){return n("div",{key:p.reg_id,staticClass:"flex mt-1 duration-300 hover:bg-gray-300 hover:bg-opacity-20 items-center h-full border-b",class:{"border border-indigo-600 bg-blue-200 bg-opacity-20 rounded-sm":-1!=e.pan_selected_index_list.indexOf(i)}},[n("div",{staticClass:"py-1 px-2 h-full w-8"},[n("input",{attrs:{type:"checkbox"},domProps:{checked:-1!=e.pan_selected_index_list.indexOf(i)},on:{click:function(t){return e.addSpliceSelected(i)}}})]),e._v(" "),e._l(e.label_list,(function(t){return n("div",{key:t.label,staticClass:"py-1 px-2 ",style:{width:t.width+"px",minWidth:t.width+"px"}},[null==p[t.key]?n("span",{},[e._v(" - ")]):"soc_sub"==t.key?n("span",{},[e._v(" "+e._s(p.soc_sub?"Oui":"Non")+" ")]):n("span",{staticClass:"break-words"},[e._v(" "+e._s(p[t.key])+" ")])])})),e._v(" "),n("div",{staticClass:"py-1 px-2 "},[n("button",{staticClass:"bt text-xs",on:{click:function(t){return e.viewPanel(p.reg_id)}}},[e._v("voir")])])],2)}))],2)]):n("div",{staticClass:"my-16 flex justify-center items-center text-gray-500"},[n("div",{staticClass:"rounded flex flex-col p-2 bg-gray-200 bg-opacity-30 shadow-lg h-32 w-72 justify-center items-center "},[n("span",{staticClass:"material-icons text-4xl"},[e._v(" location_off ")]),e._v(" "),n("span",[e._v(" Aucun régisseur à afficher. ")]),e._v(" "),n("div",{staticClass:"bg-indigo-500 hover:bg-indigo-600 hover:bg-opacity-30 flex justify-center items-center bg-opacity-30 rounded p-2 duration-300 text-indigo-600 font-bold cursor-pointer",on:{click:function(t){return e.$router.push({name:"admin-regisseur-add"})}}},[n("span",{staticClass:"material-icons "},[e._v(" add ")]),e._v(" "),n("span",{},[e._v(" Ajouter un régisseur ")])])])])])])])}),[],!1,null,null,null);t.default=component.exports}}]);