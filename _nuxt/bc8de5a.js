(window.webpackJsonp=window.webpackJsonp||[]).push([[185,17,23,31],{358:function(t,e,n){"use strict";n.r(e);var r={props:["label","type","id","autofocus","width","value"],data:function(){return{on_focus:!1,style:{height:40},input:{style:{},model:""}}},methods:{updateInput:function(){this.$emit("input",this.$refs.cinput.value)},focusInput:function(){this.$refs.cinput.focus()}},mounted:function(){},created:function(){}},o=n(7),component=Object(o.a)(r,(function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{style:t.input.style},[n("div",{staticClass:"text-xs duration-300 flex items-center font-bold h-4"},[n("label",{staticClass:"z-10 px-1 text-indigo-600",attrs:{for:t.id}},[t._v(" "+t._s(t.label)+" ")])]),t._v(" "),n("input",{ref:"cinput",staticClass:"input-alt w-full duration-300 text-xs",attrs:{autofocus:t.autofocus,id:t.id,type:t.type,placeholder:t.label},domProps:{value:t.value},on:{input:function(e){return t.updateInput()},focus:function(){t.on_focus=!0,t.$emit("focus")},blur:function(){t.on_focus=!1,t.$emit("blur")}}})])}),[],!1,null,"a221d83e",null);e.default=component.exports},359:function(t,e,n){var content=n(361);content.__esModule&&(content=content.default),"string"==typeof content&&(content=[[t.i,content,""]]),content.locals&&(t.exports=content.locals);(0,n(27).default)("2d1dc0a2",content,!0,{sourceMap:!1})},360:function(t,e,n){"use strict";n(359)},361:function(t,e,n){var r=n(26)((function(i){return i[1]}));r.push([t.i,"/*purgecss start ignore*/\n.fade-enter-active,.fade-leave-active{\n  transition:opacity .3s\n}\n.fade-enter,.fade-leave-to{\n  opacity:0\n}\n\n/*purgecss end ignore*/",""]),r.locals={},t.exports=r},362:function(t,e,n){"use strict";n.r(e);var r={props:["value","datas","label","code","placeholder","padding","width"],watch:{datas:function(a){this.$emit("input",void 0===a[0]?null:a[0][this.code])}},data:function(){return{}},methods:{updateInput:function(){this.$emit("input",this.$refs.cinput.value)}},mounted:function(){}},o=(n(360),n(7)),component=Object(o.a)(r,(function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"relative flex flex-col"},[t.placeholder?n("div",{staticClass:"text-xs duration-300 flex items-center font-bold",class:t.datas.length>0?" h-4":"h-0"},[t.datas.length>0?n("label",{staticClass:"z-10 px-1 text-indigo-600"},[t._v(" "+t._s(t.placeholder)+" ")]):t._e()]):t._e(),t._v(" "),n("div",[n("select",{ref:"cinput",staticClass:"input-alt w-full duration-300 text-xs",on:{change:function(e){return t.updateInput()}}},t._l(t.datas,(function(e){return n("option",{key:e[t.code],domProps:{value:e[t.code],selected:t.value==e[void 0===t.code?"code":t.code]}},[t._v(" "+t._s(e[void 0===t.label?"label":t.label])+" ")])})),0)])])}),[],!1,null,null,null);e.default=component.exports},391:function(t,e,n){"use strict";var r=n(4),o=n(6),l=n(57),c=n(39),d=n(48),_=n(15),f=n(5),h=n(231),v=n(159),m=n(392),x=n(393),C=n(100),y=n(394),w=[],k=o(w.sort),P=o(w.push),$=f((function(){w.sort(void 0)})),R=f((function(){w.sort(null)})),E=v("sort"),j=!f((function(){if(C)return C<70;if(!(m&&m>3)){if(x)return!0;if(y)return y<603;var code,t,e,n,r="";for(code=65;code<76;code++){switch(t=String.fromCharCode(code),code){case 66:case 69:case 70:case 72:e=3;break;case 68:case 71:e=4;break;default:e=2}for(n=0;n<47;n++)w.push({k:t+n,v:e})}for(w.sort((function(a,b){return b.v-a.v})),n=0;n<w.length;n++)t=w[n].k.charAt(0),r.charAt(r.length-1)!==t&&(r+=t);return"DGBEFHACIJK"!==r}}));r({target:"Array",proto:!0,forced:$||!R||!E||!j},{sort:function(t){void 0!==t&&l(t);var e=c(this);if(j)return void 0===t?k(e):k(e,t);var n,r,o=[],f=d(e);for(r=0;r<f;r++)r in e&&P(o,e[r]);for(h(o,function(t){return function(e,n){return void 0===n?-1:void 0===e?1:void 0!==t?+t(e,n)||0:_(e)>_(n)?1:-1}}(t)),n=o.length,r=0;r<n;)e[r]=o[r++];for(;r<f;)delete e[r++];return e}})},392:function(t,e,n){var r=n(83).match(/firefox\/(\d+)/i);t.exports=!!r&&+r[1]},393:function(t,e,n){var r=n(83);t.exports=/MSIE|Trident/.test(r)},394:function(t,e,n){var r=n(83).match(/AppleWebKit\/(\d+)\./);t.exports=!!r&&+r[1]},423:function(t,e,n){"use strict";n.r(e);var r=n(3),o=(n(25),{props:["ann_id","list_month"],data:function(){return{name_pdf:"",rapport_ann:!1,in_process:!1,text_head:"",type_portrait:[{label:"Portrait",code:1},{label:"Paysage",code:0}],isPrortrait:1}},methods:{exportPdf:function(){var t=this;return Object(r.a)(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,t.$axios.$post("api/a/solarpro/rapport/ann/"+t.ann_id+"/pdf",{titre:t.name_pdf,months:t.list_month,text_head:t.text_head,isPortrait:t.isPrortrait});case 3:e.sent.status&&t.$emit("validate"),e.next=10;break;case 7:e.prev=7,e.t0=e.catch(0),t.showErrorConnexion();case 10:case"end":return e.stop()}}),e,null,[[0,7]])})))()}},mounted:function(){}}),l=n(7),component=Object(l.a)(o,(function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"flex justify-center items-center top-0 left-0 fixed w-screen h-screen bg-white bg-opacity-75 z-50"},[n("div",{staticClass:"bg-white rounded-lg border shadow-lg ",style:{width:"500px"}},[n("div",{staticClass:"p-2 flex border-b items-center"},[n("span",[t._v("  Exporter en PDF ")]),t._v(" "),n("span",{staticClass:"flex-grow"}),t._v(" "),n("button",{staticClass:"bt-back text-sm",on:{click:function(e){return t.$emit("close")}}},[t._v(" Retour ")])]),t._v(" "),n("div",{staticClass:"flex flex-col p-2"},[n("div",{staticClass:"flex items-end mb-2"},[n("custom-input",{attrs:{label:"Nom du pdf ..."},model:{value:t.name_pdf,callback:function(e){t.name_pdf=e},expression:"name_pdf"}})],1),t._v(" "),n("div",{staticClass:"mb-2 flex flex-col"},[n("span",{staticClass:"text-indigo-600 text-xs font-bold"},[t._v(" Texte en haut du pdf ... ")]),t._v(" "),n("textarea",{directives:[{name:"model",rawName:"v-model",value:t.text_head,expression:"text_head"}],staticClass:"input-alt",attrs:{name:"",id:"",cols:"30",rows:"10"},domProps:{value:t.text_head},on:{input:function(e){e.target.composing||(t.text_head=e.target.value)}}})]),t._v(" "),n("div",{staticClass:"flex"},[n("c-select",{attrs:{label:"label",code:"code",datas:t.type_portrait,placeholder:"Orientation du PDF ..."},model:{value:t.isPortrait,callback:function(e){t.isPortrait=e},expression:"isPortrait"}})],1)]),t._v(" "),n("div",{staticClass:"py-2"},[n("button",{staticClass:"bt text-xs ml-2",on:{click:t.exportPdf}},[t._v("Exporter")])]),t._v(" "),t.in_process?n("div",{staticClass:"p-2 border-t"},[n("span",{staticClass:"text-blue-500"},[t._v(" Travail en cours .........")])]):t._e()])])}),[],!1,null,null,null);e.default=component.exports;installComponents(component,{CustomInput:n(358).default,CSelect:n(362).default})},545:function(t,e,n){"use strict";n.r(e);var r=n(3),o=(n(156),n(391),n(25),{data:function(){return{have_data:!1,list_month:[],model_list_month:["Janvier","Février","Mars","Avril","Mai","Juin","Juillet","Août","Septembre","Octobre","Novembre","Décembre"],pan_rapport:[],count_month:{},count_light:{},on_export:!1,list_pdf:[]}},methods:{getRapportAnn:function(){var t=this;return Object(r.a)(regeneratorRuntime.mark((function e(){var n;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,t.$axios.$get("api/a/solarpro/rapport/ann/"+t.$route.query.ann_id,{params:{months:t.list_month}});case 3:(n=e.sent).status?(t.pan_rapport=n.rapport,t.countPanelPerMonth()):t.showNotif("Erreur",n.message,!0),e.next=10;break;case 7:e.prev=7,e.t0=e.catch(0),t.showErrorConnexion();case 10:case"end":return e.stop()}}),e,null,[[0,7]])})))()},addMonth:function(i){var t=this.list_month.indexOf(i);-1!=t?this.list_month.splice(t,1):this.list_month.push(i),this.list_month.sort((function(a,b){return a-b}))},setSearch:function(){this.getRapportAnn()},countPanelPerMonth:function(){for(var t=(new Date).getFullYear(),e=this.pan_rapport,n={},r=0,i=0;i<e.length;i++){(n=e[i]).year_begin<t&&(n.month_begin=1),n.year_end>t&&(n.month_end=12);for(var o=0;o<this.model_list_month.length;o++)(r=o+1)<=n.month_end&&r>=n.month_begin&&(this.count_month[r]=null!=this.count_month[r]?this.count_month[r]+1:1,this.count_light[r]=null!=this.count_light[r]?this.count_light[r]+n.spp_nb_light:n.spp_nb_light)}},getListPDF:function(){var t=this;return Object(r.a)(regeneratorRuntime.mark((function e(){var n;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,t.$axios.$get("api/a/solarpro/rapport/list/pdf/ann/"+t.$route.query.ann_id);case 3:(n=e.sent).status&&(t.list_pdf=n.list_pdf),e.next=10;break;case 7:e.prev=7,e.t0=e.catch(0),t.showErrorConnexion();case 10:case"end":return e.stop()}}),e,null,[[0,7]])})))()},generatePDF:function(){var t=this;return Object(r.a)(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(t.list_month.length<=0)){e.next=2;break}return e.abrupt("return");case 2:t.on_export=!0;case 3:case"end":return e.stop()}}),e)})))()},generateReport:function(){this.$refs.html2Pdf.generatePdf()},deleteRapport:function(t){var e=this;return Object(r.a)(regeneratorRuntime.mark((function n(){var r;return regeneratorRuntime.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.prev=0,n.next=3,e.$axios.$delete("api/a/solarpro/rapport/"+t);case 3:(r=n.sent).status?e.getListPDF():e.showNotif("Erreur",r.message,!0),n.next=10;break;case 7:n.prev=7,n.t0=n.catch(0),e.showErrorConnexion();case 10:case"end":return n.stop()}}),n,null,[[0,7]])})))()}},beforeMount:function(){this.have_data=!!this.$route.query.ann_id},mounted:function(){this.setSearch(),this.getListPDF()}}),l=n(7),component=Object(l.a)(o,(function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{},[t.have_data?n("div",{},[n("div",{staticClass:"p-2 border-b flex justify-center items-center"},[n("span",[t._v(" Choisissez les mois ")]),t._v(" "),n("div",{staticClass:"mx-2 p-1 border-l"},[n("button",{class:{bt:t.list_month.length,"bt-load":!t.list_month.length},on:{click:t.generatePDF}},[t._v("Génerer PDF")])])]),t._v(" "),n("div",{staticClass:" flex flex-wrap mb-2 border-b p-2"},t._l(t.model_list_month,(function(e,i){return n("div",{key:e,staticClass:"m-1 p-2 border rounded items-center justify-center flex"},[n("input",{attrs:{type:"checkbox",id:"check_month_"+i,name:"check_month_"+i},on:{click:function(e){return t.addMonth(i+1)}}}),t._v(" "),n("label",{staticClass:"ml-1",attrs:{for:"check_month_"+i}},[t._v(" "+t._s(e)+" ")])])})),0),t._v(" "),t.list_month.length>0?n("div",{},[n("table",{},[n("thead",{staticClass:"rounded-t sticky top-0 z-20"},[n("tr",{staticClass:"bg-gray-50 text-gray-700"},[n("th",{staticClass:"p-2"},[t._v(" Ref ")]),t._v(" "),n("th",{staticClass:"p-2"},[t._v(" Régisseur ")]),t._v(" "),n("th",{staticClass:"p-2"},[t._v(" Nb. Lumière ")]),t._v(" "),t._l(t.list_month,(function(e){return n("th",{key:e,staticClass:"p-2 w-20"},[t._v(" "+t._s(t.model_list_month[parseInt(e)-1])+" ")])}))],2)]),t._v(" "),n("tbody",[t._l(t.pan_rapport,(function(p){return n("tr",{key:p.pan_id,staticClass:"border-b"},[n("td",{staticClass:"p-2 border relative"},[t._v(" "+t._s(p.pan_ref)+" ")]),t._v(" "),n("td",{staticClass:"p-2 border relative"},[t._v(" "+t._s(p.reg_label)+" ")]),t._v(" "),n("td",{staticClass:"p-2 border relative"},[t._v(" "+t._s(p.spp_nb_light)+" ")]),t._v(" "),t._l(t.list_month,(function(li){return n("td",{key:li,staticClass:"p-2 border"},[n("span",{staticClass:"flex rounded p-2 w-full h-full",class:{"bg-blue-500 border border-blue-500":li<=p.month_end&&li>=p.month_begin}})])}))],2)})),t._v(" "),n("tr",{staticClass:"shadow-lg font-bold sticky bottom-12 bg-white border"},[n("td",{staticClass:" p-2 border"},[t._v(" Total Emplacements ")]),t._v(" "),n("td",{staticClass:"p-2 border"}),t._v(" "),n("td",{staticClass:"p-2 border"}),t._v(" "),t._l(t.list_month,(function(e){return n("td",{key:e,staticClass:"border"},[n("span",{staticClass:"p-2"},[t._v(" "+t._s(t.count_month[e])+" ")])])}))],2),t._v(" "),n("tr",{staticClass:"shadow-lg font-bold sticky bottom-2 bg-white border"},[n("td",{staticClass:" p-2 border"},[t._v(" Total Lumière ")]),t._v(" "),n("td",{staticClass:"p-2 border"}),t._v(" "),n("td",{staticClass:"p-2 border"}),t._v(" "),t._l(t.list_month,(function(e){return n("td",{key:e,staticClass:"border"},[n("span",{staticClass:"p-2"},[t._v(" "+t._s(t.count_light[e])+" ")])])}))],2)],2)])]):t._e(),t._v(" "),n("div",{staticClass:"mt-2"},[n("div",{},[n("table",[t._m(0),t._v(" "),n("tbody",t._l(t.list_pdf,(function(p){return n("tr",{key:p.rapport_id,staticClass:"p-2 border"},[n("td",{staticClass:"p-2"},[n("a",{attrs:{target:"_blank",href:"/api/a/pdf/view/"+p.rapport_name}},[t._v(" "+t._s(p.rapport_title)+" ")])]),t._v(" "),n("td",{staticClass:"p-2"},[n("button",{staticClass:"bt-prev-next",on:{click:function(e){return t.deleteRapport(p.rapport_id)}}},[n("span",{staticClass:"material-icons"},[t._v("clear")])])])])})),0)])])])]):n("div",{staticClass:" w-full m-5 flex justify-center items-center "},[n("span",{},[t._v(" Aucun regisseur séléctionné ")])]),t._v(" "),t.on_export?n("export-pdf-ann",{attrs:{ann_id:t.$route.query.ann_id,list_month:t.list_month},on:{validate:function(){t.on_export=!1,t.getListPDF()},close:function(e){t.on_export=!1}}}):t._e()],1)}),[function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("thead",[n("tr",[n("th",{staticClass:"p-2 border bg-gray-50 text-gray-700"},[t._v(" Liste PDF ")]),t._v(" "),n("th",{staticClass:"p-2 border bg-gray-50 text-gray-700"},[t._v(" Suppression ")])])])}],!1,null,null,null);e.default=component.exports;installComponents(component,{ExportPdfAnn:n(423).default})}}]);