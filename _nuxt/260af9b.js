(window.webpackJsonp=window.webpackJsonp||[]).push([[142,17,23,35],{358:function(t,e,n){"use strict";n.r(e);var r={props:["label","type","id","autofocus","width","value"],data:function(){return{on_focus:!1,style:{height:40},input:{style:{},model:""}}},methods:{updateInput:function(){this.$emit("input",this.$refs.cinput.value)},focusInput:function(){this.$refs.cinput.focus()}},mounted:function(){},created:function(){}},c=n(7),component=Object(c.a)(r,(function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{style:t.input.style},[n("div",{staticClass:"text-xs duration-300 flex items-center font-bold h-4"},[n("label",{staticClass:"z-10 px-1 text-indigo-600",attrs:{for:t.id}},[t._v(" "+t._s(t.label)+" ")])]),t._v(" "),n("input",{ref:"cinput",staticClass:"input-alt w-full duration-300 text-xs",attrs:{autofocus:t.autofocus,id:t.id,type:t.type,placeholder:t.label},domProps:{value:t.value},on:{input:function(e){return t.updateInput()},focus:function(){t.on_focus=!0,t.$emit("focus")},blur:function(){t.on_focus=!1,t.$emit("blur")}}})])}),[],!1,null,"a221d83e",null);e.default=component.exports},359:function(t,e,n){var content=n(361);content.__esModule&&(content=content.default),"string"==typeof content&&(content=[[t.i,content,""]]),content.locals&&(t.exports=content.locals);(0,n(27).default)("2d1dc0a2",content,!0,{sourceMap:!1})},360:function(t,e,n){"use strict";n(359)},361:function(t,e,n){var r=n(26)((function(i){return i[1]}));r.push([t.i,"/*purgecss start ignore*/\n.fade-enter-active,.fade-leave-active{\n  transition:opacity .3s\n}\n.fade-enter,.fade-leave-to{\n  opacity:0\n}\n\n/*purgecss end ignore*/",""]),r.locals={},t.exports=r},362:function(t,e,n){"use strict";n.r(e);var r={props:["value","datas","label","code","placeholder","padding","width"],watch:{datas:function(a){this.$emit("input",void 0===a[0]?null:a[0][this.code])}},data:function(){return{}},methods:{updateInput:function(){this.$emit("input",this.$refs.cinput.value)}},mounted:function(){}},c=(n(360),n(7)),component=Object(c.a)(r,(function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"relative flex flex-col"},[t.placeholder?n("div",{staticClass:"text-xs duration-300 flex items-center font-bold",class:t.datas.length>0?" h-4":"h-0"},[t.datas.length>0?n("label",{staticClass:"z-10 px-1 text-indigo-600"},[t._v(" "+t._s(t.placeholder)+" ")]):t._e()]):t._e(),t._v(" "),n("div",[n("select",{ref:"cinput",staticClass:"input-alt w-full duration-300 text-xs",on:{change:function(e){return t.updateInput()}}},t._l(t.datas,(function(e){return n("option",{key:e[t.code],domProps:{value:e[t.code],selected:t.value==e[void 0===t.code?"code":t.code]}},[t._v(" "+t._s(e[void 0===t.label?"label":t.label])+" ")])})),0)])])}),[],!1,null,null,null);e.default=component.exports},365:function(t,e,n){var content=n(369);content.__esModule&&(content=content.default),"string"==typeof content&&(content=[[t.i,content,""]]),content.locals&&(t.exports=content.locals);(0,n(27).default)("76a25175",content,!0,{sourceMap:!1})},368:function(t,e,n){"use strict";n(365)},369:function(t,e,n){var r=n(26)((function(i){return i[1]}));r.push([t.i,"/*purgecss start ignore*/\n#map[data-v-1beb3618]{\n  height:450px\n}\n\n/*purgecss end ignore*/",""]),r.locals={},t.exports=r},371:function(t,e,n){"use strict";n.r(e);var r=n(3),c=(n(25),n(61),n(62),n(21),n(99),n(363)),l=n.n(c),o=(n(376),n(377),{props:["data_carte"],data:function(){return{mymap:{},origin_view:[-18.929670491513264,47.52685546875001],accessToken:"pk.eyJ1IjoiYW5nZWxvMTQyNyIsImEiOiJja3c0aGExMTIwNmp0Mm9udnY2bGNsZnRoIn0.PiJCKKLMoWzmULCaFs2CqA",layerGroup:{},d_carte:{lat:0,lng:0,region:"",ville:"",quartier:"",pays:""},d:["lat","lng","region","ville","quartier","pays"]}},methods:{initMap:function(){var t=this;return Object(r.a)(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t.mymap=l.a.map("map").setView(t.origin_view,16),l.a.tileLayer("https://api.mapbox.com/styles/v1/{id}/tiles/{z}/{x}/{y}?access_token={accessToken}",{attribution:'Map data &copy; <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors, Imagery © <a href="https://www.mapbox.com/">Mapbox</a>',maxZoom:18,id:"mapbox/streets-v11",tileSize:512,zoomOffset:-1,accessToken:"pk.eyJ1IjoiYW5nZWxvMTQyNyIsImEiOiJja3c0aGExMTIwNmp0Mm9udnY2bGNsZnRoIn0.PiJCKKLMoWzmULCaFs2CqA"}).addTo(t.mymap),t.layerGroup=l.a.layerGroup().addTo(t.mymap),l.a.Control.geocoder({defaultMarkGeocode:!1}).addTo(t.mymap).on("markgeocode",(function(e){t.getLocation(e.geocode.center),t.d_carte.lat=e.geocode.center.lat,t.d_carte.lng=e.geocode.center.lng,t.mymap.setView([t.d_carte.lat,t.d_carte.lng]),t.layerGroup.clearLayers(),l.a.marker([t.d_carte.lat,t.d_carte.lng]).addTo(t.layerGroup)})),t.mymap.on("click",(function(e){t.d_carte.lat=e.latlng.lat,t.d_carte.lng=e.latlng.lng,t.layerGroup.clearLayers(),l.a.marker([t.d_carte.lat,t.d_carte.lng]).addTo(t.layerGroup),t.getLocation(e.latlng)}));case 5:case"end":return e.stop()}}),e)})))()},getLocation:function(t){var e=this;return Object(r.a)(regeneratorRuntime.mark((function n(){var r,c,i,l;return regeneratorRuntime.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return e.d_carte.region="",e.d_carte.pays="",e.d_carte.ville="",e.d_carte.quartier="",n.prev=1,n.next=4,e.$axios.$get("https://api.mapbox.com/geocoding/v5/mapbox.places/".concat(t.lng,",").concat(t.lat,".json?access_token=").concat(e.accessToken));case 4:r=n.sent,console.log(r),c=r.features,i=1;case 8:if(!(i<c.length)){n.next=25;break}l=c[i].id.split(".")[0],n.t0=l,n.next="locality"===n.t0?13:"place"===n.t0?15:"region"===n.t0?17:"country"===n.t0?19:21;break;case 13:return e.d_carte.quartier=c[i].text,n.abrupt("break",22);case 15:return e.d_carte.ville=c[i].text,n.abrupt("break",22);case 17:return e.d_carte.region=c[i].text,n.abrupt("break",22);case 19:return e.d_carte.pays=c[i].text,n.abrupt("break",22);case 21:return n.abrupt("break",22);case 22:i++,n.next=8;break;case 25:n.next=30;break;case 27:n.prev=27,n.t1=n.catch(1),console.log(n.t1);case 30:case"end":return n.stop()}}),n,null,[[1,27]])})))()},setDataCarte:function(){this.$emit("validate",this.d_carte),this.$emit("close")}},mounted:function(){this.initMap()}}),d=(n(368),n(7)),component=Object(d.a)(o,(function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"w-screen h-screen bg-white bg-opacity-70 fixed top-0 left-0 flex justify-center items-center",staticStyle:{"z-index":"1010"}},[n("div",{staticClass:"rounded-lg flex bg-gray-100",staticStyle:{height:"80%",width:"80%"}},[n("button",{staticClass:"absolute top-5 right-5 bt-prev-next",on:{click:function(e){return t.$emit("close")}}},[n("span",{staticClass:"material-icons"},[t._v(" clear ")])]),t._v(" "),n("div",{staticStyle:{height:"100%",width:"70%","border-radius":"8px"},attrs:{id:"map"}}),t._v(" "),n("div",{staticClass:"flex flex-col p-5 ",staticStyle:{width:"30%"}},[t._l(t.d,(function(p,i){return n("div",{key:i,staticClass:"flex flex-col"},[n("span",{staticClass:"text-sm font-bold"},[t._v(" "+t._s(p)+" ")]),t._v(" "),n("span",{staticClass:"text-xl"},[t._v(" "+t._s(t.d_carte[p])+" ")])])})),t._v(" "),n("div",{staticClass:"p-5 flex justify-end w-full"},[n("button",{staticClass:"flex justify-center items-center bt",on:{click:t.setDataCarte}},[n("span",{staticClass:"text-sm"},[t._v(" Valider ")]),t._v(" "),n("span",{staticClass:"material-icons"},[t._v(" navigate_next ")])])])],2)])])}),[],!1,null,"1beb3618",null);e.default=component.exports},586:function(t,e,n){"use strict";n.r(e);var r=n(3),c=(n(25),{layout:"espace_agt",watch:{"pans.pan_cat":function(a){this.getFormats(a)}},data:function(){return{pans:{},reg:[],format:[],cat:[],show_carte:!1}},methods:{getUtils:function(){var t=this;return Object(r.a)(regeneratorRuntime.mark((function e(){var n;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,t.$axios.$get("api/a/mobile/panel/add");case 3:(n=e.sent).status?(t.format=n.format,t.reg=n.reg,t.cat=n.cat):t.showNotif("Erreur",n.message,!0),e.next=10;break;case 7:e.prev=7,e.t0=e.catch(0),t.showErrorConnexion();case 10:case"end":return e.stop()}}),e,null,[[0,7]])})))()},getFormats:function(a){var t=this;return Object(r.a)(regeneratorRuntime.mark((function e(){var n;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,t.$axios.$get("api/a/mobile/format/"+a);case 3:(n=e.sent).status?t.format=n.format:t.showNotif("Erreur",n.message,!0),e.next=10;break;case 7:e.prev=7,e.t0=e.catch(0),t.showErrorConnexion();case 10:case"end":return e.stop()}}),e,null,[[0,7]])})))()},postPanelAgent:function(){var t=this;return Object(r.a)(regeneratorRuntime.mark((function e(){var n;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,t.$axios.$post("api/a/mobile/panel/post/web",t.pans);case 3:(n=e.sent).status?(t.showNotif("Ajout de panneau ","Le panneau a été ajouté correctement"),t.$router.push("/agt")):t.showNotif("Erreur",n.message,!0),e.next=10;break;case 7:e.prev=7,e.t0=e.catch(0),t.showErrorConnexion();case 10:case"end":return e.stop()}}),e,null,[[0,7]])})))()},setLieu:function(p){this.pans.pan_pays=p.pays,this.pans.pan_region=p.region,this.pans.pan_quartier=p.quartier,this.pans.pan_ville=p.ville,this.pans.pan_lat=p.lat,this.pans.pan_lng=p.lng}},mounted:function(){this.getUtils()}}),l=n(7),component=Object(l.a)(c,(function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{},[n("div",{staticClass:"flex flex-col items-center justify-center"},[n("div",{staticStyle:{width:"500px","min-width":"200px"}},[t._m(0),t._v(" "),n("div",{},[n("custom-input",{staticClass:"mb-2",attrs:{label:"Référence régisseur ..."},model:{value:t.pans.pan_ref,callback:function(e){t.$set(t.pans,"pan_ref",e)},expression:"pans.pan_ref"}}),t._v(" "),n("custom-input",{staticClass:"mb-2",attrs:{label:"Surface panneau ..."},model:{value:t.pans.pan_surface,callback:function(e){t.$set(t.pans,"pan_surface",e)},expression:"pans.pan_surface"}}),t._v(" "),n("c-select",{staticClass:"mb-2",attrs:{datas:t.reg,label:"reg_label",code:"reg_id",placeholder:"Régisseur ..."},model:{value:t.pans.pan_reg,callback:function(e){t.$set(t.pans,"pan_reg",e)},expression:"pans.pan_reg"}}),t._v(" "),n("c-select",{staticClass:"mb-2",attrs:{datas:t.cat,label:"cat_label",code:"cat_id",placeholder:"Catégorie ..."},model:{value:t.pans.pan_cat,callback:function(e){t.$set(t.pans,"pan_cat",e)},expression:"pans.pan_cat"}}),t._v(" "),n("c-select",{staticClass:"mb-2",attrs:{datas:t.format,label:"format_label",code:"format_id",placeholder:"Format ..."},model:{value:t.pans.pan_format,callback:function(e){t.$set(t.pans,"pan_format",e)},expression:"pans.pan_format"}})],1)]),t._v(" "),n("div",{staticStyle:{width:"500px","min-width":"200px"}},[n("div",{staticClass:"my-2 flex items-end"},[n("span",{staticClass:"underline text-sm"},[t._v("Concernant le lieu")]),t._v(" "),n("span",{staticClass:"text-blue-500 cursor-pointer underline text-xs mx-5",on:{click:function(e){t.show_carte=!0}}},[t._v(" Par carte ")])]),t._v(" "),n("div",{},[n("custom-input",{staticClass:"mb-2",attrs:{label:"Latitude ..."},model:{value:t.pans.pan_lat,callback:function(e){t.$set(t.pans,"pan_lat",e)},expression:"pans.pan_lat"}}),t._v(" "),n("custom-input",{staticClass:"mb-2",attrs:{label:"Longitude ..."},model:{value:t.pans.pan_lng,callback:function(e){t.$set(t.pans,"pan_lng",e)},expression:"pans.pan_lng"}}),t._v(" "),n("custom-input",{staticClass:"mb-2",attrs:{label:"Pays ..."},model:{value:t.pans.pan_pays,callback:function(e){t.$set(t.pans,"pan_pays",e)},expression:"pans.pan_pays"}}),t._v(" "),n("custom-input",{staticClass:"mb-2",attrs:{label:"Ville ..."},model:{value:t.pans.pan_ville,callback:function(e){t.$set(t.pans,"pan_ville",e)},expression:"pans.pan_ville"}}),t._v(" "),n("custom-input",{staticClass:"mb-2",attrs:{label:"Région ..."},model:{value:t.pans.pan_region,callback:function(e){t.$set(t.pans,"pan_region",e)},expression:"pans.pan_region"}}),t._v(" "),n("custom-input",{staticClass:"mb-2",attrs:{label:"Quartier ..."},model:{value:t.pans.pan_quartier,callback:function(e){t.$set(t.pans,"pan_quartier",e)},expression:"pans.pan_quartier"}}),t._v(" "),n("custom-input",{staticClass:"mb-2",attrs:{label:"Lieu dit  ..."},model:{value:t.pans.pan_lieu_label,callback:function(e){t.$set(t.pans,"pan_lieu_label",e)},expression:"pans.pan_lieu_label"}}),t._v(" "),n("custom-input",{staticClass:"mb-2",attrs:{label:"Vue vers ..."},model:{value:t.pans.pan_vue_vers,callback:function(e){t.$set(t.pans,"pan_vue_vers",e)},expression:"pans.pan_vue_vers"}})],1)]),t._v(" "),n("div",{staticClass:"flex",staticStyle:{width:"500px","min-width":"200px"}},[n("button",{staticClass:"bt",on:{click:t.postPanelAgent}},[t._v(" Ajouter ")])])]),t._v(" "),n("client-only",[t.show_carte?n("insert-by-carte",{on:{close:function(e){t.show_carte=!1},validate:t.setLieu}}):t._e()],1)],1)}),[function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"my-2"},[n("span",{staticClass:"underline text-sm"},[t._v("Concernant le panneau")])])}],!1,null,null,null);e.default=component.exports;installComponents(component,{CustomInput:n(358).default,CSelect:n(362).default,InsertByCarte:n(371).default})}}]);