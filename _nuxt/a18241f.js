(window.webpackJsonp=window.webpackJsonp||[]).push([[11,23,35],{358:function(t,e,n){"use strict";n.r(e);var r={props:["label","type","id","autofocus","width","value"],data:function(){return{on_focus:!1,style:{height:40},input:{style:{},model:""}}},methods:{updateInput:function(){this.$emit("input",this.$refs.cinput.value)},focusInput:function(){this.$refs.cinput.focus()}},mounted:function(){},created:function(){}},l=n(7),component=Object(l.a)(r,(function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{style:t.input.style},[n("div",{staticClass:"text-xs duration-300 flex items-center font-bold h-4"},[n("label",{staticClass:"z-10 px-1 text-indigo-600",attrs:{for:t.id}},[t._v(" "+t._s(t.label)+" ")])]),t._v(" "),n("input",{ref:"cinput",staticClass:"input-alt w-full duration-300 text-xs",attrs:{autofocus:t.autofocus,id:t.id,type:t.type,placeholder:t.label},domProps:{value:t.value},on:{input:function(e){return t.updateInput()},focus:function(){t.on_focus=!0,t.$emit("focus")},blur:function(){t.on_focus=!1,t.$emit("blur")}}})])}),[],!1,null,"a221d83e",null);e.default=component.exports},365:function(t,e,n){var content=n(369);content.__esModule&&(content=content.default),"string"==typeof content&&(content=[[t.i,content,""]]),content.locals&&(t.exports=content.locals);(0,n(27).default)("76a25175",content,!0,{sourceMap:!1})},368:function(t,e,n){"use strict";n(365)},369:function(t,e,n){var r=n(26)((function(i){return i[1]}));r.push([t.i,"/*purgecss start ignore*/\n#map[data-v-1beb3618]{\n  height:450px\n}\n\n/*purgecss end ignore*/",""]),r.locals={},t.exports=r},371:function(t,e,n){"use strict";n.r(e);var r=n(3),l=(n(25),n(61),n(62),n(21),n(99),n(363)),c=n.n(l),o=(n(376),n(377),{props:["data_carte"],data:function(){return{mymap:{},origin_view:[-18.929670491513264,47.52685546875001],accessToken:"pk.eyJ1IjoiYW5nZWxvMTQyNyIsImEiOiJja3c0aGExMTIwNmp0Mm9udnY2bGNsZnRoIn0.PiJCKKLMoWzmULCaFs2CqA",layerGroup:{},d_carte:{lat:0,lng:0,region:"",ville:"",quartier:"",pays:""},d:["lat","lng","region","ville","quartier","pays"]}},methods:{initMap:function(){var t=this;return Object(r.a)(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t.mymap=c.a.map("map").setView(t.origin_view,16),c.a.tileLayer("https://api.mapbox.com/styles/v1/{id}/tiles/{z}/{x}/{y}?access_token={accessToken}",{attribution:'Map data &copy; <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors, Imagery © <a href="https://www.mapbox.com/">Mapbox</a>',maxZoom:18,id:"mapbox/streets-v11",tileSize:512,zoomOffset:-1,accessToken:"pk.eyJ1IjoiYW5nZWxvMTQyNyIsImEiOiJja3c0aGExMTIwNmp0Mm9udnY2bGNsZnRoIn0.PiJCKKLMoWzmULCaFs2CqA"}).addTo(t.mymap),t.layerGroup=c.a.layerGroup().addTo(t.mymap),c.a.Control.geocoder({defaultMarkGeocode:!1}).addTo(t.mymap).on("markgeocode",(function(e){t.getLocation(e.geocode.center),t.d_carte.lat=e.geocode.center.lat,t.d_carte.lng=e.geocode.center.lng,t.mymap.setView([t.d_carte.lat,t.d_carte.lng]),t.layerGroup.clearLayers(),c.a.marker([t.d_carte.lat,t.d_carte.lng]).addTo(t.layerGroup)})),t.mymap.on("click",(function(e){t.d_carte.lat=e.latlng.lat,t.d_carte.lng=e.latlng.lng,t.layerGroup.clearLayers(),c.a.marker([t.d_carte.lat,t.d_carte.lng]).addTo(t.layerGroup),t.getLocation(e.latlng)}));case 5:case"end":return e.stop()}}),e)})))()},getLocation:function(t){var e=this;return Object(r.a)(regeneratorRuntime.mark((function n(){var r,l,i,c;return regeneratorRuntime.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return e.d_carte.region="",e.d_carte.pays="",e.d_carte.ville="",e.d_carte.quartier="",n.prev=1,n.next=4,e.$axios.$get("https://api.mapbox.com/geocoding/v5/mapbox.places/".concat(t.lng,",").concat(t.lat,".json?access_token=").concat(e.accessToken));case 4:r=n.sent,console.log(r),l=r.features,i=1;case 8:if(!(i<l.length)){n.next=25;break}c=l[i].id.split(".")[0],n.t0=c,n.next="locality"===n.t0?13:"place"===n.t0?15:"region"===n.t0?17:"country"===n.t0?19:21;break;case 13:return e.d_carte.quartier=l[i].text,n.abrupt("break",22);case 15:return e.d_carte.ville=l[i].text,n.abrupt("break",22);case 17:return e.d_carte.region=l[i].text,n.abrupt("break",22);case 19:return e.d_carte.pays=l[i].text,n.abrupt("break",22);case 21:return n.abrupt("break",22);case 22:i++,n.next=8;break;case 25:n.next=30;break;case 27:n.prev=27,n.t1=n.catch(1),console.log(n.t1);case 30:case"end":return n.stop()}}),n,null,[[1,27]])})))()},setDataCarte:function(){this.$emit("validate",this.d_carte),this.$emit("close")}},mounted:function(){this.initMap()}}),d=(n(368),n(7)),component=Object(d.a)(o,(function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"w-screen h-screen bg-white bg-opacity-70 fixed top-0 left-0 flex justify-center items-center",staticStyle:{"z-index":"1010"}},[n("div",{staticClass:"rounded-lg flex bg-gray-100",staticStyle:{height:"80%",width:"80%"}},[n("button",{staticClass:"absolute top-5 right-5 bt-prev-next",on:{click:function(e){return t.$emit("close")}}},[n("span",{staticClass:"material-icons"},[t._v(" clear ")])]),t._v(" "),n("div",{staticStyle:{height:"100%",width:"70%","border-radius":"8px"},attrs:{id:"map"}}),t._v(" "),n("div",{staticClass:"flex flex-col p-5 ",staticStyle:{width:"30%"}},[t._l(t.d,(function(p,i){return n("div",{key:i,staticClass:"flex flex-col"},[n("span",{staticClass:"text-sm font-bold"},[t._v(" "+t._s(p)+" ")]),t._v(" "),n("span",{staticClass:"text-xl"},[t._v(" "+t._s(t.d_carte[p])+" ")])])})),t._v(" "),n("div",{staticClass:"p-5 flex justify-end w-full"},[n("button",{staticClass:"flex justify-center items-center bt",on:{click:t.setDataCarte}},[n("span",{staticClass:"text-sm"},[t._v(" Valider ")]),t._v(" "),n("span",{staticClass:"material-icons"},[t._v(" navigate_next ")])])])],2)])])}),[],!1,null,"1beb3618",null);e.default=component.exports},416:function(t,e,n){"use strict";n.r(e);var r=n(3),l=(n(25),n(37),n(156),n(61),{data:function(){return{qplace:{},tmp_list_image:[],on_load:!1,show_carte:!1}},methods:{setLieu:function(p){this.qplace.lieu_pays=p.pays,this.qplace.lieu_region=p.region,this.qplace.lieu_quartier=p.quartier,this.qplace.lieu_ville=p.ville,this.qplace.lieu_lat=p.lat,this.qplace.lieu_lng=p.lng},add_im:function(t){var e=this;return Object(r.a)(regeneratorRuntime.mark((function n(){var r;return regeneratorRuntime.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return e.on_load=!0,n.next=3,e.up_image(t);case 3:(r=n.sent).status&&(e.tmp_list_image.push({dimension_min_file:r.opt.dim_min_file,dimension_file:r.opt.dim_file,file_id:r.file_id,name_file:r.opt.name,name_min_file:r.opt.name+"_min"}),e.on_load=!1);case 5:case"end":return n.stop()}}),n)})))()},del_im_a:function(i){var t=this;return Object(r.a)(regeneratorRuntime.mark((function e(){var n;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.tmp_list_image[i].file_id,e.next=3,t.delete_ims_global(n);case 3:e.sent&&t.tmp_list_image.splice(i,1);case 5:case"end":return e.stop()}}),e)})))()},validatePlace:function(){var t=this;return Object(r.a)(regeneratorRuntime.mark((function e(){var n,r;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,n=t.tmp_list_image.map((function(t){return t.file_id})),e.next=4,t.$axios.$post("api/p/panel/qplace/param",{qplace:t.qplace,ims:n});case 4:(r=e.sent).status?t.$emit("close"):t.showNotif("Erreur",r.message,!0),e.next=11;break;case 8:e.prev=8,e.t0=e.catch(0),t.showErrorConnexion();case 11:case"end":return e.stop()}}),e,null,[[0,8]])})))()}}}),c=n(7),component=Object(c.a)(l,(function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",[n("div",{staticClass:"mt-5"},[n("div",{staticClass:"flex  flex-col"},[n("div",{staticClass:"mb-3 mx-2 "},[t._m(0),t._v(" "),n("div",{staticClass:"flex flex-wrap items-end"},[n("custom-input",{staticClass:"w-full",attrs:{label:"Description du lieu ..."},model:{value:t.qplace.desc_lieu,callback:function(e){t.$set(t.qplace,"desc_lieu",e)},expression:"qplace.desc_lieu"}})],1)]),t._v(" "),n("div",{},[n("div",{staticClass:"mb-3 mx-2  "},[t._m(1),t._v(" "),n("div",[n("textarea",{directives:[{name:"model",rawName:"v-model",value:t.qplace.desc,expression:"qplace.desc"}],staticClass:"input-alt w-full text-sm",attrs:{rows:"5",placeholder:"Détails du lieu ...",cols:""},domProps:{value:t.qplace.desc},on:{input:function(e){e.target.composing||t.$set(t.qplace,"desc",e.target.value)}}})])]),t._v(" "),n("div",{staticClass:"mb-3 mx-2  "},[t._m(2),t._v(" "),n("div",{staticClass:"flex"},[t._l(t.tmp_list_image,(function(e,i){return n("div",{key:e.name_file,staticClass:"relative w-28 h-28 rounded-lg flex justify-center items-center overflow-hidden bg-gray-50 border hover:border-indigo-600 m-2"},[e.name_file?n("img",{staticStyle:{width:"112px"},attrs:{src:"/api/p/media/"+e.name_file+"_min",alt:"",srcset:""}}):n("span",{staticClass:"text-6xl  material-icons"},[t._v(" perm_media ")]),t._v(" "),n("button",{staticClass:" top-1 right-1 absolute bt-prev-next text-xs",on:{click:function(e){return t.del_im_a(i)}}},[n("span",{staticClass:"material-icons"},[t._v(" clear ")])])])})),t._v(" "),t.on_load?n("div",{staticClass:"cursor-pointer  flex-col  w-28 h-28 rounded-lg flex justify-center items-center overflow-hidden bg-gray-50 border hover:border-indigo-600 m-2"},[n("span",{staticClass:"material-icons text-6xl animate-pulse text-indigo-500"},[t._v(" hourglass_bottom ")]),t._v(" "),n("span",{staticClass:" text-indigo-500 text-xs"},[t._v("Upload ...")])]):t._e(),t._v(" "),t._m(3),t._v(" "),n("input",{staticClass:"hidden",attrs:{accept:"image/*",id:"im",type:"file"},on:{change:function(e){return t.add_im(e)}}})],2)])])]),t._v(" "),n("div",{staticClass:"p-2 flex border-t"},[n("span",{staticClass:"flex-grow"}),t._v(" "),n("button",{staticClass:"bt text-sm",on:{click:t.validatePlace}},[t._v(" Valider ")])])]),t._v(" "),n("client-only",[t.show_carte?n("insert-by-carte",{on:{close:function(e){t.show_carte=!1},validate:t.setLieu}}):t._e()],1)],1)}),[function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"flex text-xs justify-center items-center font-bold py-2 mb-1 rounded-lg text-gray-100"},[n("span",{staticClass:"text-gray-600 flex-grow"},[t._v(" Dîtes-nous un peu plus sur le lieu. ")])])},function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"flex text-xs justify-center items-center font-bold py-2 mb-1 rounded-lg text-gray-100"},[n("span",{staticClass:"text-gray-600 flex-grow"},[t._v(" Plus de détails sur le lieu  ")])])},function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"flex text-xs justify-center items-center font-bold py-2 mb-1 rounded-lg text-gray-100"},[n("span",{staticClass:"text-gray-600 flex-grow"},[t._v(" Images  ")])])},function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("label",{staticClass:" cursor-pointer w-28 h-28 rounded-lg flex justify-center items-center overflow-hidden bg-gray-50 border hover:border-indigo-600 m-2",attrs:{for:"im"}},[n("span",{staticClass:"material-icons text-6xl"},[t._v(" add ")])])}],!1,null,null,null);e.default=component.exports;installComponents(component,{CustomInput:n(358).default,InsertByCarte:n(371).default})}}]);